2022-03-13 21:22:13.542824 (MainThread): Running with dbt=0.21.1
2022-03-13 21:22:14.208103 (MainThread): running dbt with arguments Namespace(record_timing_info=None, debug=False, log_format='default', write_json=True, use_colors=None, strict=False, warn_error=False, partial_parse=None, single_threaded=False, test_new_parser=False, use_experimental_parser=False, project_dir=None, profiles_dir='C:\\Users\\susch\\.dbt', profile=None, target=None, vars='{}', log_cache_events=False, use_cache=True, fail_fast=False, threads=None, version_check=True, select=None, exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
2022-03-13 21:22:14.209101 (MainThread): Tracking: tracking
2022-03-13 21:22:14.210098 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FE63BE53A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FE6515D760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FE6515D820>]}
2022-03-13 21:22:14.220071 (MainThread): Partial parsing not enabled
2022-03-13 21:22:14.244007 (MainThread): Parsing macros\adapters.sql
2022-03-13 21:22:14.282903 (MainThread): Parsing macros\catalog.sql
2022-03-13 21:22:14.284898 (MainThread): Parsing macros\materializations\incremental.sql
2022-03-13 21:22:14.291879 (MainThread): Parsing macros\materializations\merge.sql
2022-03-13 21:22:14.295869 (MainThread): Parsing macros\materializations\seed.sql
2022-03-13 21:22:14.299857 (MainThread): Parsing macros\materializations\table.sql
2022-03-13 21:22:14.302849 (MainThread): Parsing macros\materializations\view.sql
2022-03-13 21:22:14.303847 (MainThread): Parsing macros\core.sql
2022-03-13 21:22:14.306839 (MainThread): Parsing macros\adapters\common.sql
2022-03-13 21:22:14.357703 (MainThread): Parsing macros\etc\datetime.sql
2022-03-13 21:22:14.365681 (MainThread): Parsing macros\etc\get_custom_alias.sql
2022-03-13 21:22:14.366679 (MainThread): Parsing macros\etc\get_custom_database.sql
2022-03-13 21:22:14.367676 (MainThread): Parsing macros\etc\get_custom_schema.sql
2022-03-13 21:22:14.369671 (MainThread): Parsing macros\etc\is_incremental.sql
2022-03-13 21:22:14.371672 (MainThread): Parsing macros\etc\query.sql
2022-03-13 21:22:14.372664 (MainThread): Parsing macros\etc\where_subquery.sql
2022-03-13 21:22:14.374658 (MainThread): Parsing macros\materializations\helpers.sql
2022-03-13 21:22:14.384659 (MainThread): Parsing macros\materializations\test.sql
2022-03-13 21:22:14.390646 (MainThread): Parsing macros\materializations\common\merge.sql
2022-03-13 21:22:14.403609 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2022-03-13 21:22:14.405604 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2022-03-13 21:22:14.414580 (MainThread): Parsing macros\materializations\incremental\on_schema_change.sql
2022-03-13 21:22:14.432531 (MainThread): Parsing macros\materializations\seed\seed.sql
2022-03-13 21:22:14.453507 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2022-03-13 21:22:14.481373 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2022-03-13 21:22:14.484366 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2022-03-13 21:22:14.500323 (MainThread): Parsing macros\materializations\table\table.sql
2022-03-13 21:22:14.506311 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2022-03-13 21:22:14.509303 (MainThread): Parsing macros\materializations\view\view.sql
2022-03-13 21:22:14.516285 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2022-03-13 21:22:14.518279 (MainThread): Parsing macros\schema_tests\not_null.sql
2022-03-13 21:22:14.520274 (MainThread): Parsing macros\schema_tests\relationships.sql
2022-03-13 21:22:14.521271 (MainThread): Parsing macros\schema_tests\unique.sql
2022-03-13 21:22:14.706519 (MainThread): Acquiring new snowflake connection "model.fullscript_takehome.my_first_dbt_model".
2022-03-13 21:22:14.719485 (MainThread): Acquiring new snowflake connection "model.fullscript_takehome.my_second_dbt_model".
2022-03-13 21:22:14.743422 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-03-13 21:22:14.746385 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-03-13 21:22:14.748408 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-03-13 21:22:14.750403 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-03-13 21:22:14.794258 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '66cd2fc4-ae35-45c6-95cf-edf8f6073f2b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FE652963A0>]}
2022-03-13 21:22:14.798248 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2022-03-13 21:22:14.798248 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '66cd2fc4-ae35-45c6-95cf-edf8f6073f2b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FE65296D90>]}
2022-03-13 21:22:14.799245 (MainThread): Found 2 models, 4 tests, 0 snapshots, 0 analyses, 172 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2022-03-13 21:22:14.800240 (MainThread): 
2022-03-13 21:22:14.800240 (MainThread): Acquiring new snowflake connection "master".
2022-03-13 21:22:14.801239 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_SNOWFLAKE_SAMPLE_DATA".
2022-03-13 21:22:14.812210 (ThreadPoolExecutor-0_0): Using snowflake connection "list_SNOWFLAKE_SAMPLE_DATA".
2022-03-13 21:22:14.812210 (ThreadPoolExecutor-0_0): On list_SNOWFLAKE_SAMPLE_DATA: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "snowflakedb", "target_name": "dev", "connection_name": "list_SNOWFLAKE_SAMPLE_DATA"} */

    show terse schemas in database SNOWFLAKE_SAMPLE_DATA
    limit 10000
2022-03-13 21:22:14.812210 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2022-03-13 21:22:15.939664 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 8 in 1.13 seconds
2022-03-13 21:22:15.943653 (ThreadPoolExecutor-0_0): On list_SNOWFLAKE_SAMPLE_DATA: Close
2022-03-13 21:22:16.063862 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_SNOWFLAKE_SAMPLE_DATA_TPCH_SF1".
2022-03-13 21:22:16.068850 (ThreadPoolExecutor-1_0): Using snowflake connection "list_SNOWFLAKE_SAMPLE_DATA_TPCH_SF1".
2022-03-13 21:22:16.068850 (ThreadPoolExecutor-1_0): On list_SNOWFLAKE_SAMPLE_DATA_TPCH_SF1: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "snowflakedb", "target_name": "dev", "connection_name": "list_SNOWFLAKE_SAMPLE_DATA_TPCH_SF1"} */

    show terse objects in SNOWFLAKE_SAMPLE_DATA.TPCH_SF1
2022-03-13 21:22:16.069847 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2022-03-13 21:22:16.742007 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 8 in 0.67 seconds
2022-03-13 21:22:16.747988 (ThreadPoolExecutor-1_0): On list_SNOWFLAKE_SAMPLE_DATA_TPCH_SF1: Close
2022-03-13 21:22:16.900704 (MainThread): 17:22:16 | Concurrency: 10 threads (target='dev')
2022-03-13 21:22:16.901736 (MainThread): 17:22:16 | 
2022-03-13 21:22:16.918375 (Thread-1): Began running node model.fullscript_takehome.my_first_dbt_model
2022-03-13 21:22:16.919401 (Thread-1): 17:22:16 | 1 of 2 START table model TPCH_SF1.my_first_dbt_model................. [RUN]
2022-03-13 21:22:16.920367 (Thread-1): Acquiring new snowflake connection "model.fullscript_takehome.my_first_dbt_model".
2022-03-13 21:22:16.921364 (Thread-1): Compiling model.fullscript_takehome.my_first_dbt_model
2022-03-13 21:22:16.930345 (Thread-1): Writing injected SQL for node "model.fullscript_takehome.my_first_dbt_model"
2022-03-13 21:22:16.937325 (Thread-1): finished collecting timing info
2022-03-13 21:22:17.024120 (Thread-1): Writing runtime SQL for node "model.fullscript_takehome.my_first_dbt_model"
2022-03-13 21:22:17.027081 (Thread-1): Using snowflake connection "model.fullscript_takehome.my_first_dbt_model".
2022-03-13 21:22:17.028080 (Thread-1): On model.fullscript_takehome.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "snowflakedb", "target_name": "dev", "node_id": "model.fullscript_takehome.my_first_dbt_model"} */


      create or replace transient table SNOWFLAKE_SAMPLE_DATA.TPCH_SF1.my_first_dbt_model  as
      (/*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
      );
2022-03-13 21:22:17.028080 (Thread-1): Opening a new connection, currently in state init
2022-03-13 21:22:17.638660 (Thread-1): Snowflake query id: 01a2e802-0000-4558-0000-00014d8a6035
2022-03-13 21:22:17.639656 (Thread-1): Snowflake error: 003540 (42501): SQL execution error: Creating table on shared database 'SNOWFLAKE_SAMPLE_DATA' is not allowed.
2022-03-13 21:22:17.639656 (Thread-1): finished collecting timing info
2022-03-13 21:22:17.640654 (Thread-1): On model.fullscript_takehome.my_first_dbt_model: Close
2022-03-13 21:22:17.785864 (Thread-1): Database Error in model my_first_dbt_model (models\example\my_first_dbt_model.sql)
  003540 (42501): SQL execution error: Creating table on shared database 'SNOWFLAKE_SAMPLE_DATA' is not allowed.
  compiled SQL at target\run\fullscript_takehome\models\example\my_first_dbt_model.sql
Traceback (most recent call last):
  File "C:\Users\susch\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\adapters\snowflake\connections.py", line 183, in exception_handler
    yield
  File "C:\Users\susch\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\adapters\sql\connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
  File "C:\Users\susch\AppData\Local\Programs\Python\Python39\lib\site-packages\snowflake\connector\cursor.py", line 721, in execute
    Error.errorhandler_wrapper(
  File "C:\Users\susch\AppData\Local\Programs\Python\Python39\lib\site-packages\snowflake\connector\errors.py", line 258, in errorhandler_wrapper
    cursor.errorhandler(connection, cursor, error_class, error_value)
  File "C:\Users\susch\AppData\Local\Programs\Python\Python39\lib\site-packages\snowflake\connector\errors.py", line 188, in default_errorhandler
    raise error_class(
snowflake.connector.errors.ProgrammingError: 003540 (42501): SQL execution error: Creating table on shared database 'SNOWFLAKE_SAMPLE_DATA' is not allowed.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\susch\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\task\base.py", line 348, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "C:\Users\susch\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\task\base.py", line 291, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "C:\Users\susch\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\task\base.py", line 393, in run
    return self.execute(compiled_node, manifest)
  File "C:\Users\susch\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\task\run.py", line 249, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "C:\Users\susch\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\clients\jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "C:\Users\susch\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\clients\jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "C:\Users\susch\AppData\Local\Programs\Python\Python39\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "C:\Users\susch\AppData\Local\Programs\Python\Python39\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 65, in macro
  File "C:\Users\susch\AppData\Local\Programs\Python\Python39\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "C:\Users\susch\AppData\Local\Programs\Python\Python39\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "C:\Users\susch\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\clients\jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "C:\Users\susch\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\clients\jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "C:\Users\susch\AppData\Local\Programs\Python\Python39\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "C:\Users\susch\AppData\Local\Programs\Python\Python39\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "C:\Users\susch\AppData\Local\Programs\Python\Python39\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "C:\Users\susch\AppData\Local\Programs\Python\Python39\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "C:\Users\susch\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\adapters\base\impl.py", line 226, in execute
    return self.connections.execute(
  File "C:\Users\susch\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\adapters\sql\connections.py", line 131, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "C:\Users\susch\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\adapters\snowflake\connections.py", line 354, in add_query
    connection, cursor = super().add_query(
  File "C:\Users\susch\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\adapters\sql\connections.py", line 87, in add_query
    return connection, cursor
  File "C:\Users\susch\AppData\Local\Programs\Python\Python39\lib\contextlib.py", line 137, in __exit__
    self.gen.throw(typ, value, traceback)
  File "C:\Users\susch\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\adapters\snowflake\connections.py", line 200, in exception_handler
    raise DatabaseException(msg)
dbt.exceptions.DatabaseException: Database Error in model my_first_dbt_model (models\example\my_first_dbt_model.sql)
  003540 (42501): SQL execution error: Creating table on shared database 'SNOWFLAKE_SAMPLE_DATA' is not allowed.
  compiled SQL at target\run\fullscript_takehome\models\example\my_first_dbt_model.sql
2022-03-13 21:22:17.790851 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '66cd2fc4-ae35-45c6-95cf-edf8f6073f2b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FE65556F70>]}
2022-03-13 21:22:17.791848 (Thread-1): 17:22:17 | 1 of 2 ERROR creating table model TPCH_SF1.my_first_dbt_model........ [ERROR in 0.87s]
2022-03-13 21:22:17.794841 (Thread-1): Finished running node model.fullscript_takehome.my_first_dbt_model
2022-03-13 21:22:17.796841 (Thread-3): Began running node model.fullscript_takehome.my_second_dbt_model
2022-03-13 21:22:17.797831 (Thread-3): 17:22:17 | 2 of 2 SKIP relation TPCH_SF1.my_second_dbt_model.................... [SKIP]
2022-03-13 21:22:17.798828 (Thread-3): Finished running node model.fullscript_takehome.my_second_dbt_model
2022-03-13 21:22:17.801850 (MainThread): Acquiring new snowflake connection "master".
2022-03-13 21:22:17.801850 (MainThread): 17:22:17 | 
2022-03-13 21:22:17.802848 (MainThread): 17:22:17 | Finished running 1 table model, 1 view model in 3.00s.
2022-03-13 21:22:17.803817 (MainThread): Connection 'master' was properly closed.
2022-03-13 21:22:17.803817 (MainThread): Connection 'list_SNOWFLAKE_SAMPLE_DATA' was properly closed.
2022-03-13 21:22:17.803817 (MainThread): Connection 'list_SNOWFLAKE_SAMPLE_DATA_TPCH_SF1' was properly closed.
2022-03-13 21:22:17.804814 (MainThread): Connection 'model.fullscript_takehome.my_first_dbt_model' was properly closed.
2022-03-13 21:22:17.813789 (MainThread): 
2022-03-13 21:22:17.814790 (MainThread): Completed with 1 error and 0 warnings:
2022-03-13 21:22:17.826999 (MainThread): 
2022-03-13 21:22:17.827996 (MainThread): Database Error in model my_first_dbt_model (models\example\my_first_dbt_model.sql)
2022-03-13 21:22:17.836593 (MainThread):   003540 (42501): SQL execution error: Creating table on shared database 'SNOWFLAKE_SAMPLE_DATA' is not allowed.
2022-03-13 21:22:17.837579 (MainThread):   compiled SQL at target\run\fullscript_takehome\models\example\my_first_dbt_model.sql
2022-03-13 21:22:17.838572 (MainThread): 
Done. PASS=0 WARN=0 ERROR=1 SKIP=1 TOTAL=2
2022-03-13 21:22:17.839570 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FE65462D30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FE6523B340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FE6551BA30>]}
2022-03-13 21:22:17.839570 (MainThread): Flushing usage events
2022-03-13 21:24:19.815137 (MainThread): Running with dbt=0.21.1
2022-03-13 21:24:20.491983 (MainThread): running dbt with arguments Namespace(record_timing_info=None, debug=False, log_format='default', write_json=True, use_colors=None, strict=False, warn_error=False, partial_parse=None, single_threaded=False, test_new_parser=False, use_experimental_parser=False, project_dir=None, profiles_dir='C:\\Users\\susch\\.dbt', profile=None, target=None, vars='{}', log_cache_events=False, use_cache=True, fail_fast=False, threads=None, version_check=True, select=None, exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
2022-03-13 21:24:20.491983 (MainThread): Tracking: tracking
2022-03-13 21:24:20.491983 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018F91B753A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018F930ED460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018F930ED8B0>]}
2022-03-13 21:24:20.500960 (MainThread): Partial parsing not enabled
2022-03-13 21:24:20.528883 (MainThread): Parsing macros\adapters.sql
2022-03-13 21:24:20.560800 (MainThread): Parsing macros\catalog.sql
2022-03-13 21:24:20.562794 (MainThread): Parsing macros\materializations\incremental.sql
2022-03-13 21:24:20.570769 (MainThread): Parsing macros\materializations\merge.sql
2022-03-13 21:24:20.574769 (MainThread): Parsing macros\materializations\seed.sql
2022-03-13 21:24:20.577760 (MainThread): Parsing macros\materializations\table.sql
2022-03-13 21:24:20.580746 (MainThread): Parsing macros\materializations\view.sql
2022-03-13 21:24:20.581744 (MainThread): Parsing macros\core.sql
2022-03-13 21:24:20.585733 (MainThread): Parsing macros\adapters\common.sql
2022-03-13 21:24:20.633606 (MainThread): Parsing macros\etc\datetime.sql
2022-03-13 21:24:20.640587 (MainThread): Parsing macros\etc\get_custom_alias.sql
2022-03-13 21:24:20.642581 (MainThread): Parsing macros\etc\get_custom_database.sql
2022-03-13 21:24:20.643578 (MainThread): Parsing macros\etc\get_custom_schema.sql
2022-03-13 21:24:20.645574 (MainThread): Parsing macros\etc\is_incremental.sql
2022-03-13 21:24:20.646572 (MainThread): Parsing macros\etc\query.sql
2022-03-13 21:24:20.648532 (MainThread): Parsing macros\etc\where_subquery.sql
2022-03-13 21:24:20.649529 (MainThread): Parsing macros\materializations\helpers.sql
2022-03-13 21:24:20.658505 (MainThread): Parsing macros\materializations\test.sql
2022-03-13 21:24:20.664489 (MainThread): Parsing macros\materializations\common\merge.sql
2022-03-13 21:24:20.675460 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2022-03-13 21:24:20.677455 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2022-03-13 21:24:20.686431 (MainThread): Parsing macros\materializations\incremental\on_schema_change.sql
2022-03-13 21:24:20.703385 (MainThread): Parsing macros\materializations\seed\seed.sql
2022-03-13 21:24:20.722334 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2022-03-13 21:24:20.761231 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2022-03-13 21:24:20.763225 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2022-03-13 21:24:20.783173 (MainThread): Parsing macros\materializations\table\table.sql
2022-03-13 21:24:20.791152 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2022-03-13 21:24:20.795141 (MainThread): Parsing macros\materializations\view\view.sql
2022-03-13 21:24:20.803120 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2022-03-13 21:24:20.805114 (MainThread): Parsing macros\schema_tests\not_null.sql
2022-03-13 21:24:20.806112 (MainThread): Parsing macros\schema_tests\relationships.sql
2022-03-13 21:24:20.808106 (MainThread): Parsing macros\schema_tests\unique.sql
2022-03-13 21:24:20.990617 (MainThread): Acquiring new snowflake connection "model.fullscript_takehome.my_first_dbt_model".
2022-03-13 21:24:21.001588 (MainThread): Acquiring new snowflake connection "model.fullscript_takehome.my_second_dbt_model".
2022-03-13 21:24:21.025524 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-03-13 21:24:21.027518 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-03-13 21:24:21.029513 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-03-13 21:24:21.030510 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-03-13 21:24:21.071429 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '165bc637-9c69-48b4-949f-0db660be1652', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018F930ED5E0>]}
2022-03-13 21:24:21.075418 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2022-03-13 21:24:21.076416 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '165bc637-9c69-48b4-949f-0db660be1652', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018F93197EB0>]}
2022-03-13 21:24:21.076416 (MainThread): Found 2 models, 4 tests, 0 snapshots, 0 analyses, 172 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2022-03-13 21:24:21.077386 (MainThread): 
2022-03-13 21:24:21.078383 (MainThread): Acquiring new snowflake connection "master".
2022-03-13 21:24:21.079559 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_TEST_DB".
2022-03-13 21:24:21.090531 (ThreadPoolExecutor-0_0): Using snowflake connection "list_TEST_DB".
2022-03-13 21:24:21.091529 (ThreadPoolExecutor-0_0): On list_TEST_DB: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "snowflakedb", "target_name": "dev", "connection_name": "list_TEST_DB"} */

    show terse schemas in database TEST_DB
    limit 10000
2022-03-13 21:24:21.091529 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2022-03-13 21:24:21.935707 (ThreadPoolExecutor-0_0): Snowflake query id: 01a2e804-0000-4559-0000-00014d8a404d
2022-03-13 21:24:21.936704 (ThreadPoolExecutor-0_0): Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
2022-03-13 21:24:21.936704 (ThreadPoolExecutor-0_0): Error running SQL: macro list_schemas
2022-03-13 21:24:21.937701 (ThreadPoolExecutor-0_0): Rolling back transaction.
2022-03-13 21:24:21.937701 (ThreadPoolExecutor-0_0): On list_TEST_DB: Close
2022-03-13 21:24:22.068531 (MainThread): Connection 'master' was properly closed.
2022-03-13 21:24:22.068531 (MainThread): Connection 'list_TEST_DB' was properly closed.
2022-03-13 21:24:22.068531 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018F931CA280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018F93197490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018F9315F8E0>]}
2022-03-13 21:24:22.069561 (MainThread): Flushing usage events
2022-03-13 21:24:22.327007 (MainThread): Encountered an error:
2022-03-13 21:24:22.328031 (MainThread): Runtime Error
  Database error while listing schemas in database "TEST_DB"
  Database Error
    002043 (02000): SQL compilation error:
    Object does not exist, or operation cannot be performed.
2022-03-13 21:24:22.339974 (MainThread): Traceback (most recent call last):
  File "C:\Users\susch\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\adapters\snowflake\connections.py", line 183, in exception_handler
    yield
  File "C:\Users\susch\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\adapters\sql\connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
  File "C:\Users\susch\AppData\Local\Programs\Python\Python39\lib\site-packages\snowflake\connector\cursor.py", line 721, in execute
    Error.errorhandler_wrapper(
  File "C:\Users\susch\AppData\Local\Programs\Python\Python39\lib\site-packages\snowflake\connector\errors.py", line 258, in errorhandler_wrapper
    cursor.errorhandler(connection, cursor, error_class, error_value)
  File "C:\Users\susch\AppData\Local\Programs\Python\Python39\lib\site-packages\snowflake\connector\errors.py", line 188, in default_errorhandler
    raise error_class(
snowflake.connector.errors.ProgrammingError: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\susch\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\adapters\snowflake\impl.py", line 102, in list_schemas
    results = self.execute_macro(
  File "C:\Users\susch\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\adapters\base\impl.py", line 1000, in execute_macro
    result = macro_function(**kwargs)
  File "C:\Users\susch\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\clients\jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "C:\Users\susch\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\clients\jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "C:\Users\susch\AppData\Local\Programs\Python\Python39\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "C:\Users\susch\AppData\Local\Programs\Python\Python39\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 20, in macro
  File "C:\Users\susch\AppData\Local\Programs\Python\Python39\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "C:\Users\susch\AppData\Local\Programs\Python\Python39\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "C:\Users\susch\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\clients\jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "C:\Users\susch\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\clients\jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "C:\Users\susch\AppData\Local\Programs\Python\Python39\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "C:\Users\susch\AppData\Local\Programs\Python\Python39\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 42, in macro
  File "C:\Users\susch\AppData\Local\Programs\Python\Python39\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "C:\Users\susch\AppData\Local\Programs\Python\Python39\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "C:\Users\susch\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\clients\jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "C:\Users\susch\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\clients\jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "C:\Users\susch\AppData\Local\Programs\Python\Python39\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "C:\Users\susch\AppData\Local\Programs\Python\Python39\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 33, in macro
  File "C:\Users\susch\AppData\Local\Programs\Python\Python39\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "C:\Users\susch\AppData\Local\Programs\Python\Python39\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "C:\Users\susch\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\clients\jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "C:\Users\susch\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\clients\jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "C:\Users\susch\AppData\Local\Programs\Python\Python39\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "C:\Users\susch\AppData\Local\Programs\Python\Python39\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "C:\Users\susch\AppData\Local\Programs\Python\Python39\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "C:\Users\susch\AppData\Local\Programs\Python\Python39\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "C:\Users\susch\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\adapters\base\impl.py", line 226, in execute
    return self.connections.execute(
  File "C:\Users\susch\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\adapters\sql\connections.py", line 131, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "C:\Users\susch\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\adapters\snowflake\connections.py", line 354, in add_query
    connection, cursor = super().add_query(
  File "C:\Users\susch\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\adapters\sql\connections.py", line 87, in add_query
    return connection, cursor
  File "C:\Users\susch\AppData\Local\Programs\Python\Python39\lib\contextlib.py", line 137, in __exit__
    self.gen.throw(typ, value, traceback)
  File "C:\Users\susch\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\adapters\snowflake\connections.py", line 200, in exception_handler
    raise DatabaseException(msg)
dbt.exceptions.DatabaseException: Database Error
  002043 (02000): SQL compilation error:
  Object does not exist, or operation cannot be performed.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\susch\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\main.py", line 127, in main
    results, succeeded = handle_and_check(args)
  File "C:\Users\susch\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\main.py", line 205, in handle_and_check
    task, res = run_from_args(parsed)
  File "C:\Users\susch\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\main.py", line 258, in run_from_args
    results = task.run()
  File "C:\Users\susch\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\task\runnable.py", line 457, in run
    result = self.execute_with_hooks(selected_uids)
  File "C:\Users\susch\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\task\runnable.py", line 415, in execute_with_hooks
    self.before_run(adapter, selected_uids)
  File "C:\Users\susch\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\task\run.py", line 410, in before_run
    self.create_schemas(adapter, selected_uids)
  File "C:\Users\susch\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\task\runnable.py", line 546, in create_schemas
    existing_schemas_lowered.update(ls_future.result())
  File "C:\Users\susch\AppData\Local\Programs\Python\Python39\lib\concurrent\futures\_base.py", line 439, in result
    return self.__get_result()
  File "C:\Users\susch\AppData\Local\Programs\Python\Python39\lib\concurrent\futures\_base.py", line 391, in __get_result
    raise self._exception
  File "C:\Users\susch\AppData\Local\Programs\Python\Python39\lib\concurrent\futures\thread.py", line 58, in run
    result = self.fn(*self.args, **self.kwargs)
  File "C:\Users\susch\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\utils.py", line 482, in connected
    return func(*args, **kwargs)
  File "C:\Users\susch\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\task\runnable.py", line 523, in list_schemas
    for s in adapter.list_schemas(database_quoted)
  File "C:\Users\susch\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\adapters\snowflake\impl.py", line 111, in list_schemas
    raise RuntimeException(msg)
dbt.exceptions.RuntimeException: Runtime Error
  Database error while listing schemas in database "TEST_DB"
  Database Error
    002043 (02000): SQL compilation error:
    Object does not exist, or operation cannot be performed.

2022-03-13 21:26:17.775864 (MainThread): Running with dbt=0.21.1
2022-03-13 21:26:18.475092 (MainThread): running dbt with arguments Namespace(record_timing_info=None, debug=False, log_format='default', write_json=True, use_colors=None, strict=False, warn_error=False, partial_parse=None, single_threaded=False, test_new_parser=False, use_experimental_parser=False, project_dir=None, profiles_dir='C:\\Users\\susch\\.dbt', profile=None, target=None, vars='{}', log_cache_events=False, use_cache=True, fail_fast=False, threads=None, version_check=True, select=None, exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
2022-03-13 21:26:18.475092 (MainThread): Tracking: tracking
2022-03-13 21:26:18.475092 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DB96DF52B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DB9837D8B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DB9837DBB0>]}
2022-03-13 21:26:18.484068 (MainThread): Partial parsing not enabled
2022-03-13 21:26:18.509997 (MainThread): Parsing macros\adapters.sql
2022-03-13 21:26:18.546900 (MainThread): Parsing macros\catalog.sql
2022-03-13 21:26:18.547898 (MainThread): Parsing macros\materializations\incremental.sql
2022-03-13 21:26:18.557870 (MainThread): Parsing macros\materializations\merge.sql
2022-03-13 21:26:18.561859 (MainThread): Parsing macros\materializations\seed.sql
2022-03-13 21:26:18.565849 (MainThread): Parsing macros\materializations\table.sql
2022-03-13 21:26:18.568841 (MainThread): Parsing macros\materializations\view.sql
2022-03-13 21:26:18.570836 (MainThread): Parsing macros\core.sql
2022-03-13 21:26:18.574825 (MainThread): Parsing macros\adapters\common.sql
2022-03-13 21:26:18.625719 (MainThread): Parsing macros\etc\datetime.sql
2022-03-13 21:26:18.634697 (MainThread): Parsing macros\etc\get_custom_alias.sql
2022-03-13 21:26:18.635694 (MainThread): Parsing macros\etc\get_custom_database.sql
2022-03-13 21:26:18.637689 (MainThread): Parsing macros\etc\get_custom_schema.sql
2022-03-13 21:26:18.639684 (MainThread): Parsing macros\etc\is_incremental.sql
2022-03-13 21:26:18.640681 (MainThread): Parsing macros\etc\query.sql
2022-03-13 21:26:18.641678 (MainThread): Parsing macros\etc\where_subquery.sql
2022-03-13 21:26:18.643673 (MainThread): Parsing macros\materializations\helpers.sql
2022-03-13 21:26:18.652649 (MainThread): Parsing macros\materializations\test.sql
2022-03-13 21:26:18.658637 (MainThread): Parsing macros\materializations\common\merge.sql
2022-03-13 21:26:18.670601 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2022-03-13 21:26:18.672596 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2022-03-13 21:26:18.680575 (MainThread): Parsing macros\materializations\incremental\on_schema_change.sql
2022-03-13 21:26:18.697529 (MainThread): Parsing macros\materializations\seed\seed.sql
2022-03-13 21:26:18.717475 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2022-03-13 21:26:18.744403 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2022-03-13 21:26:18.745403 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2022-03-13 21:26:18.761358 (MainThread): Parsing macros\materializations\table\table.sql
2022-03-13 21:26:18.767343 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2022-03-13 21:26:18.770334 (MainThread): Parsing macros\materializations\view\view.sql
2022-03-13 21:26:18.777318 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2022-03-13 21:26:18.778313 (MainThread): Parsing macros\schema_tests\not_null.sql
2022-03-13 21:26:18.780308 (MainThread): Parsing macros\schema_tests\relationships.sql
2022-03-13 21:26:18.781306 (MainThread): Parsing macros\schema_tests\unique.sql
2022-03-13 21:26:19.014685 (MainThread): Acquiring new snowflake connection "model.fullscript_takehome.my_first_dbt_model".
2022-03-13 21:26:19.026648 (MainThread): Acquiring new snowflake connection "model.fullscript_takehome.my_second_dbt_model".
2022-03-13 21:26:19.049587 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-03-13 21:26:19.051584 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-03-13 21:26:19.053576 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-03-13 21:26:19.054574 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-03-13 21:26:19.095460 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6b321f98-3517-4a44-867f-ba565c51bee5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DB96E1C100>]}
2022-03-13 21:26:19.099421 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2022-03-13 21:26:19.099421 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6b321f98-3517-4a44-867f-ba565c51bee5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DB96E1C220>]}
2022-03-13 21:26:19.099421 (MainThread): Found 2 models, 4 tests, 0 snapshots, 0 analyses, 172 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2022-03-13 21:26:19.100419 (MainThread): 
2022-03-13 21:26:19.101416 (MainThread): Acquiring new snowflake connection "master".
2022-03-13 21:26:19.102414 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_TEST_DB".
2022-03-13 21:26:19.113417 (ThreadPoolExecutor-0_0): Using snowflake connection "list_TEST_DB".
2022-03-13 21:26:19.114382 (ThreadPoolExecutor-0_0): On list_TEST_DB: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "snowflakedb", "target_name": "dev", "connection_name": "list_TEST_DB"} */

    show terse schemas in database TEST_DB
    limit 10000
2022-03-13 21:26:19.114382 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2022-03-13 21:26:20.045701 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 2 in 0.93 seconds
2022-03-13 21:26:20.052686 (ThreadPoolExecutor-0_0): On list_TEST_DB: Close
2022-03-13 21:26:20.176073 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_TEST_DB_PUBLIC".
2022-03-13 21:26:20.197996 (ThreadPoolExecutor-1_0): Using snowflake connection "list_TEST_DB_PUBLIC".
2022-03-13 21:26:20.197996 (ThreadPoolExecutor-1_0): On list_TEST_DB_PUBLIC: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "snowflakedb", "target_name": "dev", "connection_name": "list_TEST_DB_PUBLIC"} */

    show terse objects in TEST_DB.PUBLIC
2022-03-13 21:26:20.197996 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2022-03-13 21:26:20.883441 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 0 in 0.69 seconds
2022-03-13 21:26:20.887430 (ThreadPoolExecutor-1_0): On list_TEST_DB_PUBLIC: Close
2022-03-13 21:26:21.033474 (MainThread): 17:26:21 | Concurrency: 10 threads (target='dev')
2022-03-13 21:26:21.035468 (MainThread): 17:26:21 | 
2022-03-13 21:26:21.060023 (Thread-1): Began running node model.fullscript_takehome.my_first_dbt_model
2022-03-13 21:26:21.061019 (Thread-1): 17:26:21 | 1 of 2 START table model PUBLIC.my_first_dbt_model................... [RUN]
2022-03-13 21:26:21.063008 (Thread-1): Acquiring new snowflake connection "model.fullscript_takehome.my_first_dbt_model".
2022-03-13 21:26:21.063008 (Thread-1): Compiling model.fullscript_takehome.my_first_dbt_model
2022-03-13 21:26:21.071024 (Thread-1): Writing injected SQL for node "model.fullscript_takehome.my_first_dbt_model"
2022-03-13 21:26:21.072982 (Thread-1): finished collecting timing info
2022-03-13 21:26:21.121880 (Thread-1): Writing runtime SQL for node "model.fullscript_takehome.my_first_dbt_model"
2022-03-13 21:26:21.123874 (Thread-1): Using snowflake connection "model.fullscript_takehome.my_first_dbt_model".
2022-03-13 21:26:21.123874 (Thread-1): On model.fullscript_takehome.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "snowflakedb", "target_name": "dev", "node_id": "model.fullscript_takehome.my_first_dbt_model"} */


      create or replace transient table TEST_DB.PUBLIC.my_first_dbt_model  as
      (/*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
      );
2022-03-13 21:26:21.123874 (Thread-1): Opening a new connection, currently in state init
2022-03-13 21:26:22.936951 (Thread-1): SQL status: SUCCESS 1 in 1.81 seconds
2022-03-13 21:26:22.963876 (Thread-1): finished collecting timing info
2022-03-13 21:26:22.963876 (Thread-1): On model.fullscript_takehome.my_first_dbt_model: Close
2022-03-13 21:26:23.093768 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6b321f98-3517-4a44-867f-ba565c51bee5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DB98770FD0>]}
2022-03-13 21:26:23.094766 (Thread-1): 17:26:23 | 1 of 2 OK created table model PUBLIC.my_first_dbt_model.............. [SUCCESS 1 in 2.03s]
2022-03-13 21:26:23.097827 (Thread-1): Finished running node model.fullscript_takehome.my_first_dbt_model
2022-03-13 21:26:23.099835 (Thread-3): Began running node model.fullscript_takehome.my_second_dbt_model
2022-03-13 21:26:23.100832 (Thread-3): 17:26:23 | 2 of 2 START view model PUBLIC.my_second_dbt_model................... [RUN]
2022-03-13 21:26:23.102858 (Thread-3): Acquiring new snowflake connection "model.fullscript_takehome.my_second_dbt_model".
2022-03-13 21:26:23.103821 (Thread-3): Compiling model.fullscript_takehome.my_second_dbt_model
2022-03-13 21:26:23.111801 (Thread-3): Writing injected SQL for node "model.fullscript_takehome.my_second_dbt_model"
2022-03-13 21:26:23.114787 (Thread-3): finished collecting timing info
2022-03-13 21:26:23.149719 (Thread-3): Writing runtime SQL for node "model.fullscript_takehome.my_second_dbt_model"
2022-03-13 21:26:23.151688 (Thread-3): Using snowflake connection "model.fullscript_takehome.my_second_dbt_model".
2022-03-13 21:26:23.151688 (Thread-3): On model.fullscript_takehome.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "snowflakedb", "target_name": "dev", "node_id": "model.fullscript_takehome.my_second_dbt_model"} */

  create or replace  view TEST_DB.PUBLIC.my_second_dbt_model  as (
    -- Use the `ref` function to select from other models

select *
from TEST_DB.PUBLIC.my_first_dbt_model
where id = 1
  );
2022-03-13 21:26:23.151688 (Thread-3): Opening a new connection, currently in state init
2022-03-13 21:26:23.988920 (Thread-3): SQL status: SUCCESS 1 in 0.84 seconds
2022-03-13 21:26:23.993906 (Thread-3): finished collecting timing info
2022-03-13 21:26:23.994904 (Thread-3): On model.fullscript_takehome.my_second_dbt_model: Close
2022-03-13 21:26:24.134673 (Thread-3): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6b321f98-3517-4a44-867f-ba565c51bee5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DB987C65B0>]}
2022-03-13 21:26:24.135670 (Thread-3): 17:26:24 | 2 of 2 OK created view model PUBLIC.my_second_dbt_model.............. [SUCCESS 1 in 1.03s]
2022-03-13 21:26:24.138026 (Thread-3): Finished running node model.fullscript_takehome.my_second_dbt_model
2022-03-13 21:26:24.143020 (MainThread): Acquiring new snowflake connection "master".
2022-03-13 21:26:24.144017 (MainThread): 17:26:24 | 
2022-03-13 21:26:24.145015 (MainThread): 17:26:24 | Finished running 1 table model, 1 view model in 5.04s.
2022-03-13 21:26:24.147008 (MainThread): Connection 'master' was properly closed.
2022-03-13 21:26:24.148007 (MainThread): Connection 'list_TEST_DB' was properly closed.
2022-03-13 21:26:24.148007 (MainThread): Connection 'list_TEST_DB_PUBLIC' was properly closed.
2022-03-13 21:26:24.149006 (MainThread): Connection 'model.fullscript_takehome.my_first_dbt_model' was properly closed.
2022-03-13 21:26:24.149006 (MainThread): Connection 'model.fullscript_takehome.my_second_dbt_model' was properly closed.
2022-03-13 21:26:24.167992 (MainThread): 
2022-03-13 21:26:24.169985 (MainThread): Completed successfully
2022-03-13 21:26:24.171941 (MainThread): 
Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
2022-03-13 21:26:24.174937 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DB9848A460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DB9861B940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DB9861BE50>]}
2022-03-13 21:26:24.175969 (MainThread): Flushing usage events
2022-03-13 21:43:00.109222 (MainThread): Running with dbt=0.21.1
2022-03-13 21:43:00.733033 (MainThread): running dbt with arguments Namespace(record_timing_info=None, debug=False, log_format='default', write_json=True, use_colors=None, strict=False, warn_error=False, partial_parse=None, single_threaded=False, test_new_parser=False, use_experimental_parser=False, project_dir=None, profiles_dir='C:\\Users\\susch\\.dbt', profile=None, target=None, vars='{}', log_cache_events=False, use_cache=True, fail_fast=False, threads=None, version_check=True, select=None, exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
2022-03-13 21:43:00.734031 (MainThread): Tracking: tracking
2022-03-13 21:43:00.734031 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E2E17D5130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E2E2D4D940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E2E2D4D640>]}
2022-03-13 21:43:00.743977 (MainThread): Partial parsing not enabled
2022-03-13 21:43:00.767910 (MainThread): Parsing macros\adapters.sql
2022-03-13 21:43:00.798830 (MainThread): Parsing macros\catalog.sql
2022-03-13 21:43:00.800824 (MainThread): Parsing macros\materializations\incremental.sql
2022-03-13 21:43:00.807805 (MainThread): Parsing macros\materializations\merge.sql
2022-03-13 21:43:00.810797 (MainThread): Parsing macros\materializations\seed.sql
2022-03-13 21:43:00.815791 (MainThread): Parsing macros\materializations\table.sql
2022-03-13 21:43:00.817779 (MainThread): Parsing macros\materializations\view.sql
2022-03-13 21:43:00.818776 (MainThread): Parsing macros\core.sql
2022-03-13 21:43:00.822765 (MainThread): Parsing macros\adapters\common.sql
2022-03-13 21:43:00.869639 (MainThread): Parsing macros\etc\datetime.sql
2022-03-13 21:43:00.877618 (MainThread): Parsing macros\etc\get_custom_alias.sql
2022-03-13 21:43:00.879612 (MainThread): Parsing macros\etc\get_custom_database.sql
2022-03-13 21:43:00.880610 (MainThread): Parsing macros\etc\get_custom_schema.sql
2022-03-13 21:43:00.882604 (MainThread): Parsing macros\etc\is_incremental.sql
2022-03-13 21:43:00.883602 (MainThread): Parsing macros\etc\query.sql
2022-03-13 21:43:00.884599 (MainThread): Parsing macros\etc\where_subquery.sql
2022-03-13 21:43:00.886594 (MainThread): Parsing macros\materializations\helpers.sql
2022-03-13 21:43:00.895571 (MainThread): Parsing macros\materializations\test.sql
2022-03-13 21:43:00.901555 (MainThread): Parsing macros\materializations\common\merge.sql
2022-03-13 21:43:00.914520 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2022-03-13 21:43:00.916515 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2022-03-13 21:43:00.925489 (MainThread): Parsing macros\materializations\incremental\on_schema_change.sql
2022-03-13 21:43:00.950425 (MainThread): Parsing macros\materializations\seed\seed.sql
2022-03-13 21:43:00.982338 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2022-03-13 21:43:01.009298 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2022-03-13 21:43:01.011293 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2022-03-13 21:43:01.026252 (MainThread): Parsing macros\materializations\table\table.sql
2022-03-13 21:43:01.032245 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2022-03-13 21:43:01.036225 (MainThread): Parsing macros\materializations\view\view.sql
2022-03-13 21:43:01.042211 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2022-03-13 21:43:01.044205 (MainThread): Parsing macros\schema_tests\not_null.sql
2022-03-13 21:43:01.045202 (MainThread): Parsing macros\schema_tests\relationships.sql
2022-03-13 21:43:01.046200 (MainThread): Parsing macros\schema_tests\unique.sql
2022-03-13 21:43:01.230701 (MainThread): Acquiring new snowflake connection "model.fullscript_takehome.CustomerDim".
2022-03-13 21:43:01.241677 (MainThread): Acquiring new snowflake connection "model.fullscript_takehome.OrdersFact".
2022-03-13 21:43:01.257635 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.fullscript_takehome.example

2022-03-13 21:43:01.262670 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a88eab47-7ed3-46ce-a01d-19933e9c921c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E2E2EAD0D0>]}
2022-03-13 21:43:01.295583 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2022-03-13 21:43:01.296580 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a88eab47-7ed3-46ce-a01d-19933e9c921c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E2E2CBE250>]}
2022-03-13 21:43:01.296580 (MainThread): Found 2 models, 0 tests, 0 snapshots, 0 analyses, 172 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2022-03-13 21:43:01.297594 (MainThread): 
2022-03-13 21:43:01.299720 (MainThread): Acquiring new snowflake connection "master".
2022-03-13 21:43:01.300746 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_SNOWFLAKE_SAMPLE_DATA".
2022-03-13 21:43:01.311716 (ThreadPoolExecutor-0_0): Using snowflake connection "list_SNOWFLAKE_SAMPLE_DATA".
2022-03-13 21:43:01.312713 (ThreadPoolExecutor-0_0): On list_SNOWFLAKE_SAMPLE_DATA: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "snowflakedb", "target_name": "dev", "connection_name": "list_SNOWFLAKE_SAMPLE_DATA"} */

    show terse schemas in database SNOWFLAKE_SAMPLE_DATA
    limit 10000
2022-03-13 21:43:01.312713 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2022-03-13 21:43:02.105838 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 8 in 0.79 seconds
2022-03-13 21:43:02.113828 (ThreadPoolExecutor-0_0): On list_SNOWFLAKE_SAMPLE_DATA: Close
2022-03-13 21:43:02.256574 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_SNOWFLAKE_SAMPLE_DATA_TPCH_SF1".
2022-03-13 21:43:02.279519 (ThreadPoolExecutor-1_0): Using snowflake connection "list_SNOWFLAKE_SAMPLE_DATA_TPCH_SF1".
2022-03-13 21:43:02.279519 (ThreadPoolExecutor-1_0): On list_SNOWFLAKE_SAMPLE_DATA_TPCH_SF1: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "snowflakedb", "target_name": "dev", "connection_name": "list_SNOWFLAKE_SAMPLE_DATA_TPCH_SF1"} */

    show terse objects in SNOWFLAKE_SAMPLE_DATA.TPCH_SF1
2022-03-13 21:43:02.280516 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2022-03-13 21:43:02.976569 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 8 in 0.70 seconds
2022-03-13 21:43:02.982553 (ThreadPoolExecutor-1_0): On list_SNOWFLAKE_SAMPLE_DATA_TPCH_SF1: Close
2022-03-13 21:43:03.116978 (MainThread): 17:43:03 | Concurrency: 10 threads (target='dev')
2022-03-13 21:43:03.118301 (MainThread): 17:43:03 | 
2022-03-13 21:43:03.140003 (Thread-1): Began running node model.fullscript_takehome.CustomerDim
2022-03-13 21:43:03.141033 (Thread-2): Began running node model.fullscript_takehome.OrdersFact
2022-03-13 21:43:03.142008 (Thread-1): 17:43:03 | 1 of 2 START table model TPCH_SF1.CustomerDim........................ [RUN]
2022-03-13 21:43:03.143001 (Thread-2): 17:43:03 | 2 of 2 START table model TPCH_SF1.OrdersFact......................... [RUN]
2022-03-13 21:43:03.146991 (Thread-1): Acquiring new snowflake connection "model.fullscript_takehome.CustomerDim".
2022-03-13 21:43:03.147988 (Thread-1): Compiling model.fullscript_takehome.CustomerDim
2022-03-13 21:43:03.148994 (Thread-2): Acquiring new snowflake connection "model.fullscript_takehome.OrdersFact".
2022-03-13 21:43:03.157002 (Thread-1): Writing injected SQL for node "model.fullscript_takehome.CustomerDim"
2022-03-13 21:43:03.158000 (Thread-2): Compiling model.fullscript_takehome.OrdersFact
2022-03-13 21:43:03.166977 (Thread-2): Writing injected SQL for node "model.fullscript_takehome.OrdersFact"
2022-03-13 21:43:03.168932 (Thread-1): finished collecting timing info
2022-03-13 21:43:03.189907 (Thread-2): finished collecting timing info
2022-03-13 21:43:03.263677 (Thread-1): Writing runtime SQL for node "model.fullscript_takehome.CustomerDim"
2022-03-13 21:43:03.270658 (Thread-2): Writing runtime SQL for node "model.fullscript_takehome.OrdersFact"
2022-03-13 21:43:03.274851 (Thread-1): Using snowflake connection "model.fullscript_takehome.CustomerDim".
2022-03-13 21:43:03.274851 (Thread-1): On model.fullscript_takehome.CustomerDim: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "snowflakedb", "target_name": "dev", "node_id": "model.fullscript_takehome.CustomerDim"} */


      create or replace transient table SNOWFLAKE_SAMPLE_DATA.TPCH_SF1.CustomerDim  as
      (

with source_data as (

    SELECT CUSTOMER.CUSTKEY
    , CUSTOMER.NAME AS CUSTOMERNAME
    , CUSTOMER.ADDRESS AS CUSTOMERADDRESS
    , NATION.NAME AS NATIONNAME
    , REGION.NAME AS REGIONNAME
    , CUSTOMER.PHONE AS CUSTOMERPHONE
    , CUSTOMER.ACCTBAL AS CUSTOMERACCTBAL
    , CUSTOMER.MKTSEGMENT AS CUSTOMERMKTSEGMENT
    , CUSTOMER.COMMENT AS CUSTOMERCOMMENT    
    FROM TPCH_SF1.CUSTOMER CUSTOMER
    LEFT join TPCH_SF1.NATION NATION ON CUSTOMER.NATIONKEY  = NATION.NATIONKEY
    LEFT JOIN TPCH_SF1.REGION REGION ON NATION.REGIONKEY = REGION.REGIONKEY 

)

select *
from source_data
      );
2022-03-13 21:43:03.275849 (Thread-2): Using snowflake connection "model.fullscript_takehome.OrdersFact".
2022-03-13 21:43:03.275849 (Thread-1): Opening a new connection, currently in state init
2022-03-13 21:43:03.276853 (Thread-2): On model.fullscript_takehome.OrdersFact: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "snowflakedb", "target_name": "dev", "node_id": "model.fullscript_takehome.OrdersFact"} */


      create or replace transient table SNOWFLAKE_SAMPLE_DATA.TPCH_SF1.OrdersFact  as
      (

with source_data as (

    SELECT  *
    FROM TPCH_SF1.ORDERS
    
)

select *
from source_data
      );
2022-03-13 21:43:03.277843 (Thread-2): Opening a new connection, currently in state init
2022-03-13 21:43:04.236015 (Thread-2): Snowflake query id: 01a2e817-0000-4558-0000-00014d8a60b1
2022-03-13 21:43:04.237012 (Thread-2): Snowflake error: 003540 (42501): SQL execution error: Creating table on shared database 'SNOWFLAKE_SAMPLE_DATA' is not allowed.
2022-03-13 21:43:04.237012 (Thread-2): finished collecting timing info
2022-03-13 21:43:04.238011 (Thread-2): On model.fullscript_takehome.OrdersFact: Close
2022-03-13 21:43:04.379588 (Thread-2): Database Error in model OrdersFact (models\OrdersFact.sql)
  003540 (42501): SQL execution error: Creating table on shared database 'SNOWFLAKE_SAMPLE_DATA' is not allowed.
  compiled SQL at target\run\fullscript_takehome\models\OrdersFact.sql
Traceback (most recent call last):
  File "C:\Users\susch\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\adapters\snowflake\connections.py", line 183, in exception_handler
    yield
  File "C:\Users\susch\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\adapters\sql\connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
  File "C:\Users\susch\AppData\Local\Programs\Python\Python39\lib\site-packages\snowflake\connector\cursor.py", line 721, in execute
    Error.errorhandler_wrapper(
  File "C:\Users\susch\AppData\Local\Programs\Python\Python39\lib\site-packages\snowflake\connector\errors.py", line 258, in errorhandler_wrapper
    cursor.errorhandler(connection, cursor, error_class, error_value)
  File "C:\Users\susch\AppData\Local\Programs\Python\Python39\lib\site-packages\snowflake\connector\errors.py", line 188, in default_errorhandler
    raise error_class(
snowflake.connector.errors.ProgrammingError: 003540 (42501): SQL execution error: Creating table on shared database 'SNOWFLAKE_SAMPLE_DATA' is not allowed.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\susch\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\task\base.py", line 348, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "C:\Users\susch\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\task\base.py", line 291, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "C:\Users\susch\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\task\base.py", line 393, in run
    return self.execute(compiled_node, manifest)
  File "C:\Users\susch\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\task\run.py", line 249, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "C:\Users\susch\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\clients\jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "C:\Users\susch\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\clients\jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "C:\Users\susch\AppData\Local\Programs\Python\Python39\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "C:\Users\susch\AppData\Local\Programs\Python\Python39\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 65, in macro
  File "C:\Users\susch\AppData\Local\Programs\Python\Python39\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "C:\Users\susch\AppData\Local\Programs\Python\Python39\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "C:\Users\susch\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\clients\jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "C:\Users\susch\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\clients\jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "C:\Users\susch\AppData\Local\Programs\Python\Python39\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "C:\Users\susch\AppData\Local\Programs\Python\Python39\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "C:\Users\susch\AppData\Local\Programs\Python\Python39\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "C:\Users\susch\AppData\Local\Programs\Python\Python39\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "C:\Users\susch\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\adapters\base\impl.py", line 226, in execute
    return self.connections.execute(
  File "C:\Users\susch\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\adapters\sql\connections.py", line 131, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "C:\Users\susch\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\adapters\snowflake\connections.py", line 354, in add_query
    connection, cursor = super().add_query(
  File "C:\Users\susch\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\adapters\sql\connections.py", line 87, in add_query
    return connection, cursor
  File "C:\Users\susch\AppData\Local\Programs\Python\Python39\lib\contextlib.py", line 137, in __exit__
    self.gen.throw(typ, value, traceback)
  File "C:\Users\susch\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\adapters\snowflake\connections.py", line 200, in exception_handler
    raise DatabaseException(msg)
dbt.exceptions.DatabaseException: Database Error in model OrdersFact (models\OrdersFact.sql)
  003540 (42501): SQL execution error: Creating table on shared database 'SNOWFLAKE_SAMPLE_DATA' is not allowed.
  compiled SQL at target\run\fullscript_takehome\models\OrdersFact.sql
2022-03-13 21:43:04.384575 (Thread-2): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a88eab47-7ed3-46ce-a01d-19933e9c921c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E2E3024A30>]}
2022-03-13 21:43:04.385572 (Thread-2): 17:43:04 | 2 of 2 ERROR creating table model TPCH_SF1.OrdersFact................ [ERROR in 1.24s]
2022-03-13 21:43:04.387641 (Thread-2): Finished running node model.fullscript_takehome.OrdersFact
2022-03-13 21:43:04.479006 (Thread-1): Snowflake query id: 01a2e817-0000-4557-0000-00014d8a30a9
2022-03-13 21:43:04.479006 (Thread-1): Snowflake error: 003540 (42501): SQL execution error: Creating table on shared database 'SNOWFLAKE_SAMPLE_DATA' is not allowed.
2022-03-13 21:43:04.480005 (Thread-1): finished collecting timing info
2022-03-13 21:43:04.480005 (Thread-1): On model.fullscript_takehome.CustomerDim: Close
2022-03-13 21:43:04.617845 (Thread-1): Database Error in model CustomerDim (models\CustomerDim.sql)
  003540 (42501): SQL execution error: Creating table on shared database 'SNOWFLAKE_SAMPLE_DATA' is not allowed.
  compiled SQL at target\run\fullscript_takehome\models\CustomerDim.sql
Traceback (most recent call last):
  File "C:\Users\susch\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\adapters\snowflake\connections.py", line 183, in exception_handler
    yield
  File "C:\Users\susch\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\adapters\sql\connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
  File "C:\Users\susch\AppData\Local\Programs\Python\Python39\lib\site-packages\snowflake\connector\cursor.py", line 721, in execute
    Error.errorhandler_wrapper(
  File "C:\Users\susch\AppData\Local\Programs\Python\Python39\lib\site-packages\snowflake\connector\errors.py", line 258, in errorhandler_wrapper
    cursor.errorhandler(connection, cursor, error_class, error_value)
  File "C:\Users\susch\AppData\Local\Programs\Python\Python39\lib\site-packages\snowflake\connector\errors.py", line 188, in default_errorhandler
    raise error_class(
snowflake.connector.errors.ProgrammingError: 003540 (42501): SQL execution error: Creating table on shared database 'SNOWFLAKE_SAMPLE_DATA' is not allowed.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\susch\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\task\base.py", line 348, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "C:\Users\susch\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\task\base.py", line 291, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "C:\Users\susch\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\task\base.py", line 393, in run
    return self.execute(compiled_node, manifest)
  File "C:\Users\susch\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\task\run.py", line 249, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "C:\Users\susch\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\clients\jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "C:\Users\susch\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\clients\jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "C:\Users\susch\AppData\Local\Programs\Python\Python39\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "C:\Users\susch\AppData\Local\Programs\Python\Python39\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 65, in macro
  File "C:\Users\susch\AppData\Local\Programs\Python\Python39\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "C:\Users\susch\AppData\Local\Programs\Python\Python39\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "C:\Users\susch\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\clients\jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "C:\Users\susch\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\clients\jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "C:\Users\susch\AppData\Local\Programs\Python\Python39\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "C:\Users\susch\AppData\Local\Programs\Python\Python39\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "C:\Users\susch\AppData\Local\Programs\Python\Python39\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "C:\Users\susch\AppData\Local\Programs\Python\Python39\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "C:\Users\susch\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\adapters\base\impl.py", line 226, in execute
    return self.connections.execute(
  File "C:\Users\susch\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\adapters\sql\connections.py", line 131, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "C:\Users\susch\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\adapters\snowflake\connections.py", line 354, in add_query
    connection, cursor = super().add_query(
  File "C:\Users\susch\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\adapters\sql\connections.py", line 87, in add_query
    return connection, cursor
  File "C:\Users\susch\AppData\Local\Programs\Python\Python39\lib\contextlib.py", line 137, in __exit__
    self.gen.throw(typ, value, traceback)
  File "C:\Users\susch\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\adapters\snowflake\connections.py", line 200, in exception_handler
    raise DatabaseException(msg)
dbt.exceptions.DatabaseException: Database Error in model CustomerDim (models\CustomerDim.sql)
  003540 (42501): SQL execution error: Creating table on shared database 'SNOWFLAKE_SAMPLE_DATA' is not allowed.
  compiled SQL at target\run\fullscript_takehome\models\CustomerDim.sql
2022-03-13 21:43:04.621841 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a88eab47-7ed3-46ce-a01d-19933e9c921c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E2E304E790>]}
2022-03-13 21:43:04.622831 (Thread-1): 17:43:04 | 1 of 2 ERROR creating table model TPCH_SF1.CustomerDim............... [ERROR in 1.47s]
2022-03-13 21:43:04.625804 (Thread-1): Finished running node model.fullscript_takehome.CustomerDim
2022-03-13 21:43:04.630817 (MainThread): Acquiring new snowflake connection "master".
2022-03-13 21:43:04.631814 (MainThread): 17:43:04 | 
2022-03-13 21:43:04.632778 (MainThread): 17:43:04 | Finished running 2 table models in 3.33s.
2022-03-13 21:43:04.633770 (MainThread): Connection 'master' was properly closed.
2022-03-13 21:43:04.634767 (MainThread): Connection 'list_SNOWFLAKE_SAMPLE_DATA' was properly closed.
2022-03-13 21:43:04.634767 (MainThread): Connection 'list_SNOWFLAKE_SAMPLE_DATA_TPCH_SF1' was properly closed.
2022-03-13 21:43:04.634767 (MainThread): Connection 'model.fullscript_takehome.CustomerDim' was properly closed.
2022-03-13 21:43:04.635765 (MainThread): Connection 'model.fullscript_takehome.OrdersFact' was properly closed.
2022-03-13 21:43:04.650728 (MainThread): 
2022-03-13 21:43:04.651725 (MainThread): Completed with 2 errors and 0 warnings:
2022-03-13 21:43:04.653814 (MainThread): 
2022-03-13 21:43:04.654817 (MainThread): Database Error in model OrdersFact (models\OrdersFact.sql)
2022-03-13 21:43:04.660806 (MainThread):   003540 (42501): SQL execution error: Creating table on shared database 'SNOWFLAKE_SAMPLE_DATA' is not allowed.
2022-03-13 21:43:04.667791 (MainThread):   compiled SQL at target\run\fullscript_takehome\models\OrdersFact.sql
2022-03-13 21:43:04.668785 (MainThread): 
2022-03-13 21:43:04.669781 (MainThread): Database Error in model CustomerDim (models\CustomerDim.sql)
2022-03-13 21:43:04.671778 (MainThread):   003540 (42501): SQL execution error: Creating table on shared database 'SNOWFLAKE_SAMPLE_DATA' is not allowed.
2022-03-13 21:43:04.679514 (MainThread):   compiled SQL at target\run\fullscript_takehome\models\CustomerDim.sql
2022-03-13 21:43:04.684643 (MainThread): 
Done. PASS=0 WARN=0 ERROR=2 SKIP=0 TOTAL=2
2022-03-13 21:43:04.685634 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E2E31631F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E2E3135910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E2E2DDCB50>]}
2022-03-13 21:43:04.686641 (MainThread): Flushing usage events
2022-03-13 21:56:41.383722 (MainThread): Running with dbt=0.21.1
2022-03-13 21:56:42.106332 (MainThread): running dbt with arguments Namespace(record_timing_info=None, debug=False, log_format='default', write_json=True, use_colors=None, strict=False, warn_error=False, partial_parse=None, single_threaded=False, test_new_parser=False, use_experimental_parser=False, project_dir=None, profiles_dir='C:\\Users\\susch\\.dbt', profile=None, target=None, vars='{}', log_cache_events=False, use_cache=True, fail_fast=False, threads=None, version_check=True, select=None, exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
2022-03-13 21:56:42.107334 (MainThread): Tracking: tracking
2022-03-13 21:56:42.107334 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021EB0B85460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021EB20FCD30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021EB20FCBB0>]}
2022-03-13 21:56:42.117303 (MainThread): Partial parsing not enabled
2022-03-13 21:56:42.144235 (MainThread): Parsing macros\adapters.sql
2022-03-13 21:56:42.176145 (MainThread): Parsing macros\catalog.sql
2022-03-13 21:56:42.178139 (MainThread): Parsing macros\materializations\incremental.sql
2022-03-13 21:56:42.186117 (MainThread): Parsing macros\materializations\merge.sql
2022-03-13 21:56:42.189110 (MainThread): Parsing macros\materializations\seed.sql
2022-03-13 21:56:42.193115 (MainThread): Parsing macros\materializations\table.sql
2022-03-13 21:56:42.195099 (MainThread): Parsing macros\materializations\view.sql
2022-03-13 21:56:42.197096 (MainThread): Parsing macros\core.sql
2022-03-13 21:56:42.200085 (MainThread): Parsing macros\adapters\common.sql
2022-03-13 21:56:42.247925 (MainThread): Parsing macros\etc\datetime.sql
2022-03-13 21:56:42.256902 (MainThread): Parsing macros\etc\get_custom_alias.sql
2022-03-13 21:56:42.257927 (MainThread): Parsing macros\etc\get_custom_database.sql
2022-03-13 21:56:42.259922 (MainThread): Parsing macros\etc\get_custom_schema.sql
2022-03-13 21:56:42.261915 (MainThread): Parsing macros\etc\is_incremental.sql
2022-03-13 21:56:42.263911 (MainThread): Parsing macros\etc\query.sql
2022-03-13 21:56:42.264908 (MainThread): Parsing macros\etc\where_subquery.sql
2022-03-13 21:56:42.265904 (MainThread): Parsing macros\materializations\helpers.sql
2022-03-13 21:56:42.274886 (MainThread): Parsing macros\materializations\test.sql
2022-03-13 21:56:42.281866 (MainThread): Parsing macros\materializations\common\merge.sql
2022-03-13 21:56:42.292839 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2022-03-13 21:56:42.295826 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2022-03-13 21:56:42.303803 (MainThread): Parsing macros\materializations\incremental\on_schema_change.sql
2022-03-13 21:56:42.320762 (MainThread): Parsing macros\materializations\seed\seed.sql
2022-03-13 21:56:42.340709 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2022-03-13 21:56:42.366639 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2022-03-13 21:56:42.368634 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2022-03-13 21:56:42.383596 (MainThread): Parsing macros\materializations\table\table.sql
2022-03-13 21:56:42.390576 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2022-03-13 21:56:42.394566 (MainThread): Parsing macros\materializations\view\view.sql
2022-03-13 21:56:42.410493 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2022-03-13 21:56:42.422490 (MainThread): Parsing macros\schema_tests\not_null.sql
2022-03-13 21:56:42.425488 (MainThread): Parsing macros\schema_tests\relationships.sql
2022-03-13 21:56:42.428442 (MainThread): Parsing macros\schema_tests\unique.sql
2022-03-13 21:56:42.620927 (MainThread): Acquiring new snowflake connection "model.fullscript_takehome.CustomerDim".
2022-03-13 21:56:42.631897 (MainThread): Acquiring new snowflake connection "model.fullscript_takehome.OrdersFact".
2022-03-13 21:56:42.646857 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.fullscript_takehome.example

2022-03-13 21:56:42.653029 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '740806ee-493c-450f-b571-df4e349bd97b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021EB223CD90>]}
2022-03-13 21:56:42.688956 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2022-03-13 21:56:42.688956 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '740806ee-493c-450f-b571-df4e349bd97b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021EB0C573A0>]}
2022-03-13 21:56:42.688956 (MainThread): Found 2 models, 0 tests, 0 snapshots, 0 analyses, 172 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2022-03-13 21:56:42.689931 (MainThread): 
2022-03-13 21:56:42.690959 (MainThread): Acquiring new snowflake connection "master".
2022-03-13 21:56:42.698388 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_TEST_DB".
2022-03-13 21:56:42.710380 (ThreadPoolExecutor-0_0): Using snowflake connection "list_TEST_DB".
2022-03-13 21:56:42.710380 (ThreadPoolExecutor-0_0): On list_TEST_DB: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "snowflakedb", "target_name": "dev", "connection_name": "list_TEST_DB"} */

    show terse schemas in database TEST_DB
    limit 10000
2022-03-13 21:56:42.710380 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2022-03-13 21:56:43.728621 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 2 in 1.02 seconds
2022-03-13 21:56:43.736599 (ThreadPoolExecutor-0_0): On list_TEST_DB: Close
2022-03-13 21:56:43.874370 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_TEST_DB_PUBLIC".
2022-03-13 21:56:43.884343 (ThreadPoolExecutor-1_0): Using snowflake connection "list_TEST_DB_PUBLIC".
2022-03-13 21:56:43.884343 (ThreadPoolExecutor-1_0): On list_TEST_DB_PUBLIC: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "snowflakedb", "target_name": "dev", "connection_name": "list_TEST_DB_PUBLIC"} */

    show terse objects in TEST_DB.PUBLIC
2022-03-13 21:56:43.884343 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2022-03-13 21:56:44.401112 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 2 in 0.52 seconds
2022-03-13 21:56:44.403135 (ThreadPoolExecutor-1_0): On list_TEST_DB_PUBLIC: Close
2022-03-13 21:56:44.528566 (MainThread): 17:56:44 | Concurrency: 10 threads (target='dev')
2022-03-13 21:56:44.529568 (MainThread): 17:56:44 | 
2022-03-13 21:56:44.552603 (Thread-1): Began running node model.fullscript_takehome.CustomerDim
2022-03-13 21:56:44.553608 (Thread-2): Began running node model.fullscript_takehome.OrdersFact
2022-03-13 21:56:44.554598 (Thread-1): 17:56:44 | 1 of 2 START table model PUBLIC.CustomerDim.......................... [RUN]
2022-03-13 21:56:44.555633 (Thread-2): 17:56:44 | 2 of 2 START table model PUBLIC.OrdersFact........................... [RUN]
2022-03-13 21:56:44.557628 (Thread-1): Acquiring new snowflake connection "model.fullscript_takehome.CustomerDim".
2022-03-13 21:56:44.557628 (Thread-1): Compiling model.fullscript_takehome.CustomerDim
2022-03-13 21:56:44.559589 (Thread-2): Acquiring new snowflake connection "model.fullscript_takehome.OrdersFact".
2022-03-13 21:56:44.567602 (Thread-1): Writing injected SQL for node "model.fullscript_takehome.CustomerDim"
2022-03-13 21:56:44.568561 (Thread-2): Compiling model.fullscript_takehome.OrdersFact
2022-03-13 21:56:44.575550 (Thread-2): Writing injected SQL for node "model.fullscript_takehome.OrdersFact"
2022-03-13 21:56:44.577542 (Thread-1): finished collecting timing info
2022-03-13 21:56:44.598518 (Thread-2): finished collecting timing info
2022-03-13 21:56:44.712204 (Thread-1): Writing runtime SQL for node "model.fullscript_takehome.CustomerDim"
2022-03-13 21:56:44.714201 (Thread-2): Writing runtime SQL for node "model.fullscript_takehome.OrdersFact"
2022-03-13 21:56:44.717194 (Thread-1): Using snowflake connection "model.fullscript_takehome.CustomerDim".
2022-03-13 21:56:44.718191 (Thread-2): Using snowflake connection "model.fullscript_takehome.OrdersFact".
2022-03-13 21:56:44.718191 (Thread-1): On model.fullscript_takehome.CustomerDim: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "snowflakedb", "target_name": "dev", "node_id": "model.fullscript_takehome.CustomerDim"} */


      create or replace transient table TEST_DB.PUBLIC.CustomerDim  as
      (

with source_data as (

    SELECT CUSTOMER.CUSTKEY
    , CUSTOMER.NAME AS CUSTOMERNAME
    , CUSTOMER.ADDRESS AS CUSTOMERADDRESS
    , NATION.NAME AS NATIONNAME
    , REGION.NAME AS REGIONNAME
    , CUSTOMER.PHONE AS CUSTOMERPHONE
    , CUSTOMER.ACCTBAL AS CUSTOMERACCTBAL
    , CUSTOMER.MKTSEGMENT AS CUSTOMERMKTSEGMENT
    , CUSTOMER.COMMENT AS CUSTOMERCOMMENT    
    FROM TPCH_SF1.CUSTOMER CUSTOMER
    LEFT join TPCH_SF1.NATION NATION ON CUSTOMER.NATIONKEY  = NATION.NATIONKEY
    LEFT JOIN TPCH_SF1.REGION REGION ON NATION.REGIONKEY = REGION.REGIONKEY 

)

select *
from source_data
      );
2022-03-13 21:56:44.719157 (Thread-2): On model.fullscript_takehome.OrdersFact: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "snowflakedb", "target_name": "dev", "node_id": "model.fullscript_takehome.OrdersFact"} */


      create or replace transient table TEST_DB.PUBLIC.OrdersFact  as
      (

use schema snowflake_sample_data.tpch_sf1;
2022-03-13 21:56:44.719157 (Thread-1): Opening a new connection, currently in state init
2022-03-13 21:56:44.719157 (Thread-2): Opening a new connection, currently in state init
2022-03-13 21:56:45.640409 (Thread-1): Snowflake query id: 01a2e824-0000-4558-0000-00014d8a6221
2022-03-13 21:56:45.640409 (Thread-1): Snowflake error: 002003 (02000): SQL compilation error:
Schema 'TEST_DB.TPCH_SF1' does not exist or not authorized.
2022-03-13 21:56:45.641401 (Thread-1): finished collecting timing info
2022-03-13 21:56:45.642398 (Thread-1): On model.fullscript_takehome.CustomerDim: Close
2022-03-13 21:56:45.770013 (Thread-2): Snowflake query id: 01a2e824-0000-4559-0000-00014d8a4245
2022-03-13 21:56:45.772008 (Thread-2): Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 4 at position 0 unexpected 'use'.
2022-03-13 21:56:45.772008 (Thread-2): finished collecting timing info
2022-03-13 21:56:45.773005 (Thread-2): On model.fullscript_takehome.OrdersFact: Close
2022-03-13 21:56:45.771041 (Thread-1): Database Error in model CustomerDim (models\CustomerDim.sql)
  002003 (02000): SQL compilation error:
  Schema 'TEST_DB.TPCH_SF1' does not exist or not authorized.
  compiled SQL at target\run\fullscript_takehome\models\CustomerDim.sql
Traceback (most recent call last):
  File "C:\Users\susch\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\adapters\snowflake\connections.py", line 183, in exception_handler
    yield
  File "C:\Users\susch\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\adapters\sql\connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
  File "C:\Users\susch\AppData\Local\Programs\Python\Python39\lib\site-packages\snowflake\connector\cursor.py", line 721, in execute
    Error.errorhandler_wrapper(
  File "C:\Users\susch\AppData\Local\Programs\Python\Python39\lib\site-packages\snowflake\connector\errors.py", line 258, in errorhandler_wrapper
    cursor.errorhandler(connection, cursor, error_class, error_value)
  File "C:\Users\susch\AppData\Local\Programs\Python\Python39\lib\site-packages\snowflake\connector\errors.py", line 188, in default_errorhandler
    raise error_class(
snowflake.connector.errors.ProgrammingError: 002003 (02000): SQL compilation error:
Schema 'TEST_DB.TPCH_SF1' does not exist or not authorized.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\susch\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\task\base.py", line 348, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "C:\Users\susch\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\task\base.py", line 291, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "C:\Users\susch\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\task\base.py", line 393, in run
    return self.execute(compiled_node, manifest)
  File "C:\Users\susch\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\task\run.py", line 249, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "C:\Users\susch\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\clients\jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "C:\Users\susch\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\clients\jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "C:\Users\susch\AppData\Local\Programs\Python\Python39\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "C:\Users\susch\AppData\Local\Programs\Python\Python39\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 65, in macro
  File "C:\Users\susch\AppData\Local\Programs\Python\Python39\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "C:\Users\susch\AppData\Local\Programs\Python\Python39\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "C:\Users\susch\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\clients\jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "C:\Users\susch\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\clients\jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "C:\Users\susch\AppData\Local\Programs\Python\Python39\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "C:\Users\susch\AppData\Local\Programs\Python\Python39\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "C:\Users\susch\AppData\Local\Programs\Python\Python39\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "C:\Users\susch\AppData\Local\Programs\Python\Python39\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "C:\Users\susch\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\adapters\base\impl.py", line 226, in execute
    return self.connections.execute(
  File "C:\Users\susch\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\adapters\sql\connections.py", line 131, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "C:\Users\susch\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\adapters\snowflake\connections.py", line 354, in add_query
    connection, cursor = super().add_query(
  File "C:\Users\susch\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\adapters\sql\connections.py", line 87, in add_query
    return connection, cursor
  File "C:\Users\susch\AppData\Local\Programs\Python\Python39\lib\contextlib.py", line 137, in __exit__
    self.gen.throw(typ, value, traceback)
  File "C:\Users\susch\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\adapters\snowflake\connections.py", line 200, in exception_handler
    raise DatabaseException(msg)
dbt.exceptions.DatabaseException: Database Error in model CustomerDim (models\CustomerDim.sql)
  002003 (02000): SQL compilation error:
  Schema 'TEST_DB.TPCH_SF1' does not exist or not authorized.
  compiled SQL at target\run\fullscript_takehome\models\CustomerDim.sql
2022-03-13 21:56:45.783973 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '740806ee-493c-450f-b571-df4e349bd97b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021EB20FE2B0>]}
2022-03-13 21:56:45.784974 (Thread-1): 17:56:45 | 1 of 2 ERROR creating table model PUBLIC.CustomerDim................. [ERROR in 1.23s]
2022-03-13 21:56:45.787780 (Thread-1): Finished running node model.fullscript_takehome.CustomerDim
2022-03-13 21:56:45.910216 (Thread-2): Database Error in model OrdersFact (models\OrdersFact.sql)
  001003 (42000): SQL compilation error:
  syntax error line 4 at position 0 unexpected 'use'.
  compiled SQL at target\run\fullscript_takehome\models\OrdersFact.sql
Traceback (most recent call last):
  File "C:\Users\susch\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\adapters\snowflake\connections.py", line 183, in exception_handler
    yield
  File "C:\Users\susch\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\adapters\sql\connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
  File "C:\Users\susch\AppData\Local\Programs\Python\Python39\lib\site-packages\snowflake\connector\cursor.py", line 721, in execute
    Error.errorhandler_wrapper(
  File "C:\Users\susch\AppData\Local\Programs\Python\Python39\lib\site-packages\snowflake\connector\errors.py", line 258, in errorhandler_wrapper
    cursor.errorhandler(connection, cursor, error_class, error_value)
  File "C:\Users\susch\AppData\Local\Programs\Python\Python39\lib\site-packages\snowflake\connector\errors.py", line 188, in default_errorhandler
    raise error_class(
snowflake.connector.errors.ProgrammingError: 001003 (42000): SQL compilation error:
syntax error line 4 at position 0 unexpected 'use'.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\susch\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\task\base.py", line 348, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "C:\Users\susch\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\task\base.py", line 291, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "C:\Users\susch\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\task\base.py", line 393, in run
    return self.execute(compiled_node, manifest)
  File "C:\Users\susch\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\task\run.py", line 249, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "C:\Users\susch\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\clients\jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "C:\Users\susch\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\clients\jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "C:\Users\susch\AppData\Local\Programs\Python\Python39\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "C:\Users\susch\AppData\Local\Programs\Python\Python39\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 65, in macro
  File "C:\Users\susch\AppData\Local\Programs\Python\Python39\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "C:\Users\susch\AppData\Local\Programs\Python\Python39\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "C:\Users\susch\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\clients\jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "C:\Users\susch\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\clients\jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "C:\Users\susch\AppData\Local\Programs\Python\Python39\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "C:\Users\susch\AppData\Local\Programs\Python\Python39\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "C:\Users\susch\AppData\Local\Programs\Python\Python39\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "C:\Users\susch\AppData\Local\Programs\Python\Python39\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "C:\Users\susch\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\adapters\base\impl.py", line 226, in execute
    return self.connections.execute(
  File "C:\Users\susch\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\adapters\sql\connections.py", line 131, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "C:\Users\susch\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\adapters\snowflake\connections.py", line 354, in add_query
    connection, cursor = super().add_query(
  File "C:\Users\susch\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\adapters\sql\connections.py", line 87, in add_query
    return connection, cursor
  File "C:\Users\susch\AppData\Local\Programs\Python\Python39\lib\contextlib.py", line 137, in __exit__
    self.gen.throw(typ, value, traceback)
  File "C:\Users\susch\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\adapters\snowflake\connections.py", line 200, in exception_handler
    raise DatabaseException(msg)
dbt.exceptions.DatabaseException: Database Error in model OrdersFact (models\OrdersFact.sql)
  001003 (42000): SQL compilation error:
  syntax error line 4 at position 0 unexpected 'use'.
  compiled SQL at target\run\fullscript_takehome\models\OrdersFact.sql
2022-03-13 21:56:45.914202 (Thread-2): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '740806ee-493c-450f-b571-df4e349bd97b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021EB23F8370>]}
2022-03-13 21:56:45.916198 (Thread-2): 17:56:45 | 2 of 2 ERROR creating table model PUBLIC.OrdersFact.................. [ERROR in 1.36s]
2022-03-13 21:56:45.918427 (Thread-2): Finished running node model.fullscript_takehome.OrdersFact
2022-03-13 21:56:45.923457 (MainThread): Acquiring new snowflake connection "master".
2022-03-13 21:56:45.924455 (MainThread): 17:56:45 | 
2022-03-13 21:56:45.925501 (MainThread): 17:56:45 | Finished running 2 table models in 3.23s.
2022-03-13 21:56:45.928410 (MainThread): Connection 'master' was properly closed.
2022-03-13 21:56:45.928410 (MainThread): Connection 'list_TEST_DB' was properly closed.
2022-03-13 21:56:45.929441 (MainThread): Connection 'list_TEST_DB_PUBLIC' was properly closed.
2022-03-13 21:56:45.929441 (MainThread): Connection 'model.fullscript_takehome.CustomerDim' was properly closed.
2022-03-13 21:56:45.930405 (MainThread): Connection 'model.fullscript_takehome.OrdersFact' was properly closed.
2022-03-13 21:56:45.945362 (MainThread): 
2022-03-13 21:56:45.946396 (MainThread): Completed with 2 errors and 0 warnings:
2022-03-13 21:56:45.949456 (MainThread): 
2022-03-13 21:56:45.951463 (MainThread): Database Error in model CustomerDim (models\CustomerDim.sql)
2022-03-13 21:56:45.958743 (MainThread):   002003 (02000): SQL compilation error:
2022-03-13 21:56:45.965382 (MainThread):   Schema 'TEST_DB.TPCH_SF1' does not exist or not authorized.
2022-03-13 21:56:45.967334 (MainThread):   compiled SQL at target\run\fullscript_takehome\models\CustomerDim.sql
2022-03-13 21:56:45.970324 (MainThread): 
2022-03-13 21:56:45.981368 (MainThread): Database Error in model OrdersFact (models\OrdersFact.sql)
2022-03-13 21:56:45.987364 (MainThread):   001003 (42000): SQL compilation error:
2022-03-13 21:56:45.989363 (MainThread):   syntax error line 4 at position 0 unexpected 'use'.
2022-03-13 21:56:45.997798 (MainThread):   compiled SQL at target\run\fullscript_takehome\models\OrdersFact.sql
2022-03-13 21:56:45.999788 (MainThread): 
Done. PASS=0 WARN=0 ERROR=2 SKIP=0 TOTAL=2
2022-03-13 21:56:46.006543 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021EB0CEC310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021EB219A310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021EB20F0640>]}
2022-03-13 21:56:46.008540 (MainThread): Flushing usage events
2022-03-13 22:03:17.858499 (MainThread): Running with dbt=0.21.1
2022-03-13 22:03:18.580573 (MainThread): running dbt with arguments Namespace(record_timing_info=None, debug=False, log_format='default', write_json=True, use_colors=None, strict=False, warn_error=False, partial_parse=None, single_threaded=False, test_new_parser=False, use_experimental_parser=False, project_dir=None, profiles_dir='C:\\Users\\susch\\.dbt', profile=None, target=None, vars='{}', log_cache_events=False, use_cache=True, fail_fast=False, threads=None, version_check=True, select=None, exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
2022-03-13 22:03:18.580573 (MainThread): Tracking: tracking
2022-03-13 22:03:18.581572 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000178B5F95610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000178B7505BE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000178B7505850>]}
2022-03-13 22:03:18.589555 (MainThread): Partial parsing not enabled
2022-03-13 22:03:18.615487 (MainThread): Parsing macros\adapters.sql
2022-03-13 22:03:18.647402 (MainThread): Parsing macros\catalog.sql
2022-03-13 22:03:18.649394 (MainThread): Parsing macros\materializations\incremental.sql
2022-03-13 22:03:18.657373 (MainThread): Parsing macros\materializations\merge.sql
2022-03-13 22:03:18.660365 (MainThread): Parsing macros\materializations\seed.sql
2022-03-13 22:03:18.665320 (MainThread): Parsing macros\materializations\table.sql
2022-03-13 22:03:18.668312 (MainThread): Parsing macros\materializations\view.sql
2022-03-13 22:03:18.669309 (MainThread): Parsing macros\core.sql
2022-03-13 22:03:18.673298 (MainThread): Parsing macros\adapters\common.sql
2022-03-13 22:03:18.732172 (MainThread): Parsing macros\etc\datetime.sql
2022-03-13 22:03:18.739154 (MainThread): Parsing macros\etc\get_custom_alias.sql
2022-03-13 22:03:18.740152 (MainThread): Parsing macros\etc\get_custom_database.sql
2022-03-13 22:03:18.742150 (MainThread): Parsing macros\etc\get_custom_schema.sql
2022-03-13 22:03:18.744140 (MainThread): Parsing macros\etc\is_incremental.sql
2022-03-13 22:03:18.745143 (MainThread): Parsing macros\etc\query.sql
2022-03-13 22:03:18.746136 (MainThread): Parsing macros\etc\where_subquery.sql
2022-03-13 22:03:18.748130 (MainThread): Parsing macros\materializations\helpers.sql
2022-03-13 22:03:18.757073 (MainThread): Parsing macros\materializations\test.sql
2022-03-13 22:03:18.763090 (MainThread): Parsing macros\materializations\common\merge.sql
2022-03-13 22:03:18.776051 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2022-03-13 22:03:18.777048 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2022-03-13 22:03:18.786029 (MainThread): Parsing macros\materializations\incremental\on_schema_change.sql
2022-03-13 22:03:18.802983 (MainThread): Parsing macros\materializations\seed\seed.sql
2022-03-13 22:03:18.823928 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2022-03-13 22:03:18.851852 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2022-03-13 22:03:18.852850 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2022-03-13 22:03:18.868807 (MainThread): Parsing macros\materializations\table\table.sql
2022-03-13 22:03:18.874794 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2022-03-13 22:03:18.877783 (MainThread): Parsing macros\materializations\view\view.sql
2022-03-13 22:03:18.884761 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2022-03-13 22:03:18.886760 (MainThread): Parsing macros\schema_tests\not_null.sql
2022-03-13 22:03:18.887752 (MainThread): Parsing macros\schema_tests\relationships.sql
2022-03-13 22:03:18.888749 (MainThread): Parsing macros\schema_tests\unique.sql
2022-03-13 22:03:19.096166 (MainThread): Acquiring new snowflake connection "model.fullscript_takehome.CustomerDim".
2022-03-13 22:03:19.109133 (MainThread): Acquiring new snowflake connection "model.fullscript_takehome.OrdersFact".
2022-03-13 22:03:19.125122 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.fullscript_takehome.example

2022-03-13 22:03:19.129938 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2f0c7f1f-e990-462c-b45b-76b1834699d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000178B764E670>]}
2022-03-13 22:03:19.162878 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2022-03-13 22:03:19.162878 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2f0c7f1f-e990-462c-b45b-76b1834699d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000178B747E220>]}
2022-03-13 22:03:19.162878 (MainThread): Found 2 models, 0 tests, 0 snapshots, 0 analyses, 172 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2022-03-13 22:03:19.163875 (MainThread): 
2022-03-13 22:03:19.164922 (MainThread): Acquiring new snowflake connection "master".
2022-03-13 22:03:19.165753 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_SNOWFLAKE_SAMPLE_DATA".
2022-03-13 22:03:19.178724 (ThreadPoolExecutor-0_0): Using snowflake connection "list_SNOWFLAKE_SAMPLE_DATA".
2022-03-13 22:03:19.178724 (ThreadPoolExecutor-0_0): On list_SNOWFLAKE_SAMPLE_DATA: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "snowflakedb", "target_name": "prod", "connection_name": "list_SNOWFLAKE_SAMPLE_DATA"} */

    show terse schemas in database SNOWFLAKE_SAMPLE_DATA
    limit 10000
2022-03-13 22:03:19.178724 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2022-03-13 22:03:19.976175 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 8 in 0.80 seconds
2022-03-13 22:03:19.984152 (ThreadPoolExecutor-0_0): On list_SNOWFLAKE_SAMPLE_DATA: Close
2022-03-13 22:03:20.130640 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_SNOWFLAKE_SAMPLE_DATA_TPCH_SF1".
2022-03-13 22:03:20.162141 (ThreadPoolExecutor-1_0): Using snowflake connection "list_SNOWFLAKE_SAMPLE_DATA_TPCH_SF1".
2022-03-13 22:03:20.163136 (ThreadPoolExecutor-1_0): On list_SNOWFLAKE_SAMPLE_DATA_TPCH_SF1: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "snowflakedb", "target_name": "prod", "connection_name": "list_SNOWFLAKE_SAMPLE_DATA_TPCH_SF1"} */

    show terse objects in SNOWFLAKE_SAMPLE_DATA.TPCH_SF1
2022-03-13 22:03:20.163136 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2022-03-13 22:03:20.915751 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 8 in 0.75 seconds
2022-03-13 22:03:20.920737 (ThreadPoolExecutor-1_0): On list_SNOWFLAKE_SAMPLE_DATA_TPCH_SF1: Close
2022-03-13 22:03:21.055874 (MainThread): 18:03:21 | Concurrency: 10 threads (target='prod')
2022-03-13 22:03:21.056870 (MainThread): 18:03:21 | 
2022-03-13 22:03:21.073410 (Thread-1): Began running node model.fullscript_takehome.CustomerDim
2022-03-13 22:03:21.074378 (Thread-2): Began running node model.fullscript_takehome.OrdersFact
2022-03-13 22:03:21.076371 (Thread-1): 18:03:21 | 1 of 2 START table model TPCH_SF1.CustomerDim........................ [RUN]
2022-03-13 22:03:21.077394 (Thread-2): 18:03:21 | 2 of 2 START table model TPCH_SF1.OrdersFact......................... [RUN]
2022-03-13 22:03:21.078371 (Thread-1): Acquiring new snowflake connection "model.fullscript_takehome.CustomerDim".
2022-03-13 22:03:21.079362 (Thread-1): Compiling model.fullscript_takehome.CustomerDim
2022-03-13 22:03:21.082350 (Thread-2): Acquiring new snowflake connection "model.fullscript_takehome.OrdersFact".
2022-03-13 22:03:21.089366 (Thread-2): Compiling model.fullscript_takehome.OrdersFact
2022-03-13 22:03:21.088370 (Thread-1): Writing injected SQL for node "model.fullscript_takehome.CustomerDim"
2022-03-13 22:03:21.096353 (Thread-2): Writing injected SQL for node "model.fullscript_takehome.OrdersFact"
2022-03-13 22:03:21.099310 (Thread-1): finished collecting timing info
2022-03-13 22:03:21.100301 (Thread-2): finished collecting timing info
2022-03-13 22:03:21.163158 (Thread-2): Writing runtime SQL for node "model.fullscript_takehome.OrdersFact"
2022-03-13 22:03:21.165152 (Thread-1): Writing runtime SQL for node "model.fullscript_takehome.CustomerDim"
2022-03-13 22:03:21.167147 (Thread-2): Using snowflake connection "model.fullscript_takehome.OrdersFact".
2022-03-13 22:03:21.168145 (Thread-1): Using snowflake connection "model.fullscript_takehome.CustomerDim".
2022-03-13 22:03:21.168145 (Thread-2): On model.fullscript_takehome.OrdersFact: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "snowflakedb", "target_name": "prod", "node_id": "model.fullscript_takehome.OrdersFact"} */


      create or replace transient table SNOWFLAKE_SAMPLE_DATA.TPCH_SF1.OrdersFact  as
      (

use schema snowflake_sample_data.tpch_sf1;
2022-03-13 22:03:21.168145 (Thread-1): On model.fullscript_takehome.CustomerDim: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "snowflakedb", "target_name": "prod", "node_id": "model.fullscript_takehome.CustomerDim"} */


      create or replace transient table SNOWFLAKE_SAMPLE_DATA.TPCH_SF1.CustomerDim  as
      (

use schema snowflake_sample_data.tpch_sf1;
2022-03-13 22:03:21.168145 (Thread-2): Opening a new connection, currently in state init
2022-03-13 22:03:21.168145 (Thread-1): Opening a new connection, currently in state init
2022-03-13 22:03:22.167733 (Thread-1): Snowflake query id: 01a2e82b-0000-4558-0000-00014d8a6251
2022-03-13 22:03:22.167733 (Thread-1): Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 4 at position 0 unexpected 'use'.
2022-03-13 22:03:22.168730 (Thread-1): finished collecting timing info
2022-03-13 22:03:22.168730 (Thread-1): On model.fullscript_takehome.CustomerDim: Close
2022-03-13 22:03:22.175712 (Thread-2): Snowflake query id: 01a2e82b-0000-4559-0000-00014d8a4271
2022-03-13 22:03:22.175712 (Thread-2): Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 4 at position 0 unexpected 'use'.
2022-03-13 22:03:22.176683 (Thread-2): finished collecting timing info
2022-03-13 22:03:22.176683 (Thread-2): On model.fullscript_takehome.OrdersFact: Close
2022-03-13 22:03:22.310510 (Thread-2): Database Error in model OrdersFact (models\OrdersFact.sql)
  001003 (42000): SQL compilation error:
  syntax error line 4 at position 0 unexpected 'use'.
  compiled SQL at target\run\fullscript_takehome\models\OrdersFact.sql
Traceback (most recent call last):
  File "C:\Users\susch\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\adapters\snowflake\connections.py", line 183, in exception_handler
    yield
  File "C:\Users\susch\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\adapters\sql\connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
  File "C:\Users\susch\AppData\Local\Programs\Python\Python39\lib\site-packages\snowflake\connector\cursor.py", line 721, in execute
    Error.errorhandler_wrapper(
  File "C:\Users\susch\AppData\Local\Programs\Python\Python39\lib\site-packages\snowflake\connector\errors.py", line 258, in errorhandler_wrapper
    cursor.errorhandler(connection, cursor, error_class, error_value)
  File "C:\Users\susch\AppData\Local\Programs\Python\Python39\lib\site-packages\snowflake\connector\errors.py", line 188, in default_errorhandler
    raise error_class(
snowflake.connector.errors.ProgrammingError: 001003 (42000): SQL compilation error:
syntax error line 4 at position 0 unexpected 'use'.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\susch\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\task\base.py", line 348, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "C:\Users\susch\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\task\base.py", line 291, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "C:\Users\susch\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\task\base.py", line 393, in run
    return self.execute(compiled_node, manifest)
  File "C:\Users\susch\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\task\run.py", line 249, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "C:\Users\susch\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\clients\jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "C:\Users\susch\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\clients\jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "C:\Users\susch\AppData\Local\Programs\Python\Python39\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "C:\Users\susch\AppData\Local\Programs\Python\Python39\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 65, in macro
  File "C:\Users\susch\AppData\Local\Programs\Python\Python39\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "C:\Users\susch\AppData\Local\Programs\Python\Python39\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "C:\Users\susch\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\clients\jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "C:\Users\susch\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\clients\jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "C:\Users\susch\AppData\Local\Programs\Python\Python39\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "C:\Users\susch\AppData\Local\Programs\Python\Python39\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "C:\Users\susch\AppData\Local\Programs\Python\Python39\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "C:\Users\susch\AppData\Local\Programs\Python\Python39\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "C:\Users\susch\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\adapters\base\impl.py", line 226, in execute
    return self.connections.execute(
  File "C:\Users\susch\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\adapters\sql\connections.py", line 131, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "C:\Users\susch\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\adapters\snowflake\connections.py", line 354, in add_query
    connection, cursor = super().add_query(
  File "C:\Users\susch\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\adapters\sql\connections.py", line 87, in add_query
    return connection, cursor
  File "C:\Users\susch\AppData\Local\Programs\Python\Python39\lib\contextlib.py", line 137, in __exit__
    self.gen.throw(typ, value, traceback)
  File "C:\Users\susch\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\adapters\snowflake\connections.py", line 200, in exception_handler
    raise DatabaseException(msg)
dbt.exceptions.DatabaseException: Database Error in model OrdersFact (models\OrdersFact.sql)
  001003 (42000): SQL compilation error:
  syntax error line 4 at position 0 unexpected 'use'.
  compiled SQL at target\run\fullscript_takehome\models\OrdersFact.sql
2022-03-13 22:03:22.316503 (Thread-2): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2f0c7f1f-e990-462c-b45b-76b1834699d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000178B78F4B50>]}
2022-03-13 22:03:22.309520 (Thread-1): Database Error in model CustomerDim (models\CustomerDim.sql)
  001003 (42000): SQL compilation error:
  syntax error line 4 at position 0 unexpected 'use'.
  compiled SQL at target\run\fullscript_takehome\models\CustomerDim.sql
Traceback (most recent call last):
  File "C:\Users\susch\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\adapters\snowflake\connections.py", line 183, in exception_handler
    yield
  File "C:\Users\susch\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\adapters\sql\connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
  File "C:\Users\susch\AppData\Local\Programs\Python\Python39\lib\site-packages\snowflake\connector\cursor.py", line 721, in execute
    Error.errorhandler_wrapper(
  File "C:\Users\susch\AppData\Local\Programs\Python\Python39\lib\site-packages\snowflake\connector\errors.py", line 258, in errorhandler_wrapper
    cursor.errorhandler(connection, cursor, error_class, error_value)
  File "C:\Users\susch\AppData\Local\Programs\Python\Python39\lib\site-packages\snowflake\connector\errors.py", line 188, in default_errorhandler
    raise error_class(
snowflake.connector.errors.ProgrammingError: 001003 (42000): SQL compilation error:
syntax error line 4 at position 0 unexpected 'use'.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\susch\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\task\base.py", line 348, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "C:\Users\susch\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\task\base.py", line 291, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "C:\Users\susch\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\task\base.py", line 393, in run
    return self.execute(compiled_node, manifest)
  File "C:\Users\susch\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\task\run.py", line 249, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "C:\Users\susch\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\clients\jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "C:\Users\susch\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\clients\jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "C:\Users\susch\AppData\Local\Programs\Python\Python39\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "C:\Users\susch\AppData\Local\Programs\Python\Python39\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 65, in macro
  File "C:\Users\susch\AppData\Local\Programs\Python\Python39\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "C:\Users\susch\AppData\Local\Programs\Python\Python39\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "C:\Users\susch\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\clients\jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "C:\Users\susch\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\clients\jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "C:\Users\susch\AppData\Local\Programs\Python\Python39\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "C:\Users\susch\AppData\Local\Programs\Python\Python39\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "C:\Users\susch\AppData\Local\Programs\Python\Python39\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "C:\Users\susch\AppData\Local\Programs\Python\Python39\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "C:\Users\susch\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\adapters\base\impl.py", line 226, in execute
    return self.connections.execute(
  File "C:\Users\susch\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\adapters\sql\connections.py", line 131, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "C:\Users\susch\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\adapters\snowflake\connections.py", line 354, in add_query
    connection, cursor = super().add_query(
  File "C:\Users\susch\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\adapters\sql\connections.py", line 87, in add_query
    return connection, cursor
  File "C:\Users\susch\AppData\Local\Programs\Python\Python39\lib\contextlib.py", line 137, in __exit__
    self.gen.throw(typ, value, traceback)
  File "C:\Users\susch\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\adapters\snowflake\connections.py", line 200, in exception_handler
    raise DatabaseException(msg)
dbt.exceptions.DatabaseException: Database Error in model CustomerDim (models\CustomerDim.sql)
  001003 (42000): SQL compilation error:
  syntax error line 4 at position 0 unexpected 'use'.
  compiled SQL at target\run\fullscript_takehome\models\CustomerDim.sql
2022-03-13 22:03:22.319457 (Thread-2): 18:03:22 | 2 of 2 ERROR creating table model TPCH_SF1.OrdersFact................ [ERROR in 1.24s]
2022-03-13 22:03:22.320489 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2f0c7f1f-e990-462c-b45b-76b1834699d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000178B78AB820>]}
2022-03-13 22:03:22.321456 (Thread-1): 18:03:22 | 1 of 2 ERROR creating table model TPCH_SF1.CustomerDim............... [ERROR in 1.24s]
2022-03-13 22:03:22.323481 (Thread-2): Finished running node model.fullscript_takehome.OrdersFact
2022-03-13 22:03:22.326474 (Thread-1): Finished running node model.fullscript_takehome.CustomerDim
2022-03-13 22:03:22.329425 (MainThread): Acquiring new snowflake connection "master".
2022-03-13 22:03:22.330456 (MainThread): 18:03:22 | 
2022-03-13 22:03:22.331457 (MainThread): 18:03:22 | Finished running 2 table models in 3.17s.
2022-03-13 22:03:22.332420 (MainThread): Connection 'master' was properly closed.
2022-03-13 22:03:22.333420 (MainThread): Connection 'list_SNOWFLAKE_SAMPLE_DATA' was properly closed.
2022-03-13 22:03:22.333420 (MainThread): Connection 'list_SNOWFLAKE_SAMPLE_DATA_TPCH_SF1' was properly closed.
2022-03-13 22:03:22.334413 (MainThread): Connection 'model.fullscript_takehome.CustomerDim' was properly closed.
2022-03-13 22:03:22.334413 (MainThread): Connection 'model.fullscript_takehome.OrdersFact' was properly closed.
2022-03-13 22:03:22.344421 (MainThread): 
2022-03-13 22:03:22.345418 (MainThread): Completed with 2 errors and 0 warnings:
2022-03-13 22:03:22.347887 (MainThread): 
2022-03-13 22:03:22.351408 (MainThread): Database Error in model OrdersFact (models\OrdersFact.sql)
2022-03-13 22:03:22.355135 (MainThread):   001003 (42000): SQL compilation error:
2022-03-13 22:03:22.362918 (MainThread):   syntax error line 4 at position 0 unexpected 'use'.
2022-03-13 22:03:22.362918 (MainThread):   compiled SQL at target\run\fullscript_takehome\models\OrdersFact.sql
2022-03-13 22:03:22.363918 (MainThread): 
2022-03-13 22:03:22.365516 (MainThread): Database Error in model CustomerDim (models\CustomerDim.sql)
2022-03-13 22:03:22.369108 (MainThread):   001003 (42000): SQL compilation error:
2022-03-13 22:03:22.374550 (MainThread):   syntax error line 4 at position 0 unexpected 'use'.
2022-03-13 22:03:22.375553 (MainThread):   compiled SQL at target\run\fullscript_takehome\models\CustomerDim.sql
2022-03-13 22:03:22.376547 (MainThread): 
Done. PASS=0 WARN=0 ERROR=2 SKIP=0 TOTAL=2
2022-03-13 22:03:22.377547 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000178B750E190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000178B750E880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000178B750E760>]}
2022-03-13 22:03:22.377547 (MainThread): Flushing usage events
2022-03-13 22:04:14.915818 (MainThread): Running with dbt=0.21.1
2022-03-13 22:04:15.622960 (MainThread): running dbt with arguments Namespace(record_timing_info=None, debug=False, log_format='default', write_json=True, use_colors=None, strict=False, warn_error=False, partial_parse=None, single_threaded=False, test_new_parser=False, use_experimental_parser=False, project_dir=None, profiles_dir='C:\\Users\\susch\\.dbt', profile=None, target=None, vars='{}', log_cache_events=False, use_cache=True, fail_fast=False, threads=None, version_check=True, select=None, exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
2022-03-13 22:04:15.622960 (MainThread): Tracking: tracking
2022-03-13 22:04:15.622960 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029864265340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000298657D7550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000298657D79A0>]}
2022-03-13 22:04:15.631935 (MainThread): Partial parsing not enabled
2022-03-13 22:04:15.657866 (MainThread): Parsing macros\adapters.sql
2022-03-13 22:04:15.689749 (MainThread): Parsing macros\catalog.sql
2022-03-13 22:04:15.691772 (MainThread): Parsing macros\materializations\incremental.sql
2022-03-13 22:04:15.698759 (MainThread): Parsing macros\materializations\merge.sql
2022-03-13 22:04:15.702746 (MainThread): Parsing macros\materializations\seed.sql
2022-03-13 22:04:15.706736 (MainThread): Parsing macros\materializations\table.sql
2022-03-13 22:04:15.709730 (MainThread): Parsing macros\materializations\view.sql
2022-03-13 22:04:15.710724 (MainThread): Parsing macros\core.sql
2022-03-13 22:04:15.713717 (MainThread): Parsing macros\adapters\common.sql
2022-03-13 22:04:15.779509 (MainThread): Parsing macros\etc\datetime.sql
2022-03-13 22:04:15.789481 (MainThread): Parsing macros\etc\get_custom_alias.sql
2022-03-13 22:04:15.790479 (MainThread): Parsing macros\etc\get_custom_database.sql
2022-03-13 22:04:15.792473 (MainThread): Parsing macros\etc\get_custom_schema.sql
2022-03-13 22:04:15.794468 (MainThread): Parsing macros\etc\is_incremental.sql
2022-03-13 22:04:15.795465 (MainThread): Parsing macros\etc\query.sql
2022-03-13 22:04:15.796463 (MainThread): Parsing macros\etc\where_subquery.sql
2022-03-13 22:04:15.797460 (MainThread): Parsing macros\materializations\helpers.sql
2022-03-13 22:04:15.807433 (MainThread): Parsing macros\materializations\test.sql
2022-03-13 22:04:15.812420 (MainThread): Parsing macros\materializations\common\merge.sql
2022-03-13 22:04:15.838353 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2022-03-13 22:04:15.841345 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2022-03-13 22:04:15.853344 (MainThread): Parsing macros\materializations\incremental\on_schema_change.sql
2022-03-13 22:04:15.870293 (MainThread): Parsing macros\materializations\seed\seed.sql
2022-03-13 22:04:15.890247 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2022-03-13 22:04:15.918170 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2022-03-13 22:04:15.919168 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2022-03-13 22:04:15.935119 (MainThread): Parsing macros\materializations\table\table.sql
2022-03-13 22:04:15.950087 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2022-03-13 22:04:15.959058 (MainThread): Parsing macros\materializations\view\view.sql
2022-03-13 22:04:15.975022 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2022-03-13 22:04:15.980004 (MainThread): Parsing macros\schema_tests\not_null.sql
2022-03-13 22:04:15.982967 (MainThread): Parsing macros\schema_tests\relationships.sql
2022-03-13 22:04:15.986954 (MainThread): Parsing macros\schema_tests\unique.sql
2022-03-13 22:04:16.190438 (MainThread): Acquiring new snowflake connection "model.fullscript_takehome.CustomerDim".
2022-03-13 22:04:16.201415 (MainThread): Acquiring new snowflake connection "model.fullscript_takehome.OrdersFact".
2022-03-13 22:04:16.218362 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.fullscript_takehome.example

2022-03-13 22:04:16.223321 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ffb7603c-ca8f-4fe3-9ef7-53463932d2f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029865915EB0>]}
2022-03-13 22:04:16.258229 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2022-03-13 22:04:16.259226 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ffb7603c-ca8f-4fe3-9ef7-53463932d2f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002986574E220>]}
2022-03-13 22:04:16.259226 (MainThread): Found 2 models, 0 tests, 0 snapshots, 0 analyses, 172 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2022-03-13 22:04:16.260222 (MainThread): 
2022-03-13 22:04:16.261248 (MainThread): Acquiring new snowflake connection "master".
2022-03-13 22:04:16.268745 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_SNOWFLAKE_SAMPLE_DATA".
2022-03-13 22:04:16.279688 (ThreadPoolExecutor-0_0): Using snowflake connection "list_SNOWFLAKE_SAMPLE_DATA".
2022-03-13 22:04:16.280714 (ThreadPoolExecutor-0_0): On list_SNOWFLAKE_SAMPLE_DATA: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "snowflakedb", "target_name": "prod", "connection_name": "list_SNOWFLAKE_SAMPLE_DATA"} */

    show terse schemas in database SNOWFLAKE_SAMPLE_DATA
    limit 10000
2022-03-13 22:04:16.280714 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2022-03-13 22:04:17.152612 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 8 in 0.87 seconds
2022-03-13 22:04:17.160589 (ThreadPoolExecutor-0_0): On list_SNOWFLAKE_SAMPLE_DATA: Close
2022-03-13 22:04:17.360185 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_SNOWFLAKE_SAMPLE_DATA_TPCH_SF1".
2022-03-13 22:04:17.383153 (ThreadPoolExecutor-1_0): Using snowflake connection "list_SNOWFLAKE_SAMPLE_DATA_TPCH_SF1".
2022-03-13 22:04:17.383153 (ThreadPoolExecutor-1_0): On list_SNOWFLAKE_SAMPLE_DATA_TPCH_SF1: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "snowflakedb", "target_name": "prod", "connection_name": "list_SNOWFLAKE_SAMPLE_DATA_TPCH_SF1"} */

    show terse objects in SNOWFLAKE_SAMPLE_DATA.TPCH_SF1
2022-03-13 22:04:17.384153 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2022-03-13 22:04:18.122378 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 8 in 0.74 seconds
2022-03-13 22:04:18.125370 (ThreadPoolExecutor-1_0): On list_SNOWFLAKE_SAMPLE_DATA_TPCH_SF1: Close
2022-03-13 22:04:18.251078 (MainThread): 18:04:18 | Concurrency: 10 threads (target='prod')
2022-03-13 22:04:18.252076 (MainThread): 18:04:18 | 
2022-03-13 22:04:18.275025 (Thread-1): Began running node model.fullscript_takehome.CustomerDim
2022-03-13 22:04:18.276029 (Thread-2): Began running node model.fullscript_takehome.OrdersFact
2022-03-13 22:04:18.278023 (Thread-1): 18:04:18 | 1 of 2 START table model TPCH_SF1.CustomerDim........................ [RUN]
2022-03-13 22:04:18.278990 (Thread-2): 18:04:18 | 2 of 2 START table model TPCH_SF1.OrdersFact......................... [RUN]
2022-03-13 22:04:18.281975 (Thread-1): Acquiring new snowflake connection "model.fullscript_takehome.CustomerDim".
2022-03-13 22:04:18.282971 (Thread-1): Compiling model.fullscript_takehome.CustomerDim
2022-03-13 22:04:18.283976 (Thread-2): Acquiring new snowflake connection "model.fullscript_takehome.OrdersFact".
2022-03-13 22:04:18.292986 (Thread-1): Writing injected SQL for node "model.fullscript_takehome.CustomerDim"
2022-03-13 22:04:18.292986 (Thread-2): Compiling model.fullscript_takehome.OrdersFact
2022-03-13 22:04:18.300962 (Thread-2): Writing injected SQL for node "model.fullscript_takehome.OrdersFact"
2022-03-13 22:04:18.302923 (Thread-1): finished collecting timing info
2022-03-13 22:04:18.309937 (Thread-2): finished collecting timing info
2022-03-13 22:04:18.387691 (Thread-1): Writing runtime SQL for node "model.fullscript_takehome.CustomerDim"
2022-03-13 22:04:18.404646 (Thread-2): Writing runtime SQL for node "model.fullscript_takehome.OrdersFact"
2022-03-13 22:04:18.410668 (Thread-1): Using snowflake connection "model.fullscript_takehome.CustomerDim".
2022-03-13 22:04:18.412662 (Thread-2): Using snowflake connection "model.fullscript_takehome.OrdersFact".
2022-03-13 22:04:18.413660 (Thread-1): On model.fullscript_takehome.CustomerDim: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "snowflakedb", "target_name": "prod", "node_id": "model.fullscript_takehome.CustomerDim"} */


      create or replace transient table SNOWFLAKE_SAMPLE_DATA.TPCH_SF1.CustomerDim  as
      (

use schema tpch_sf1;
2022-03-13 22:04:18.414623 (Thread-2): On model.fullscript_takehome.OrdersFact: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "snowflakedb", "target_name": "prod", "node_id": "model.fullscript_takehome.OrdersFact"} */


      create or replace transient table SNOWFLAKE_SAMPLE_DATA.TPCH_SF1.OrdersFact  as
      (

use schema tpch_sf1;
2022-03-13 22:04:18.414623 (Thread-1): Opening a new connection, currently in state init
2022-03-13 22:04:18.415657 (Thread-2): Opening a new connection, currently in state init
2022-03-13 22:04:19.598298 (Thread-1): Snowflake query id: 01a2e82c-0000-4559-0000-00014d8a4275
2022-03-13 22:04:19.598298 (Thread-1): Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 4 at position 0 unexpected 'use'.
2022-03-13 22:04:19.598298 (Thread-1): finished collecting timing info
2022-03-13 22:04:19.599296 (Thread-1): On model.fullscript_takehome.CustomerDim: Close
2022-03-13 22:04:19.660451 (Thread-2): Snowflake query id: 01a2e82c-0000-4559-0000-00014d8a4279
2022-03-13 22:04:19.661446 (Thread-2): Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 4 at position 0 unexpected 'use'.
2022-03-13 22:04:19.662443 (Thread-2): finished collecting timing info
2022-03-13 22:04:19.662443 (Thread-2): On model.fullscript_takehome.OrdersFact: Close
2022-03-13 22:04:19.732916 (Thread-1): Database Error in model CustomerDim (models\CustomerDim.sql)
  001003 (42000): SQL compilation error:
  syntax error line 4 at position 0 unexpected 'use'.
  compiled SQL at target\run\fullscript_takehome\models\CustomerDim.sql
Traceback (most recent call last):
  File "C:\Users\susch\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\adapters\snowflake\connections.py", line 183, in exception_handler
    yield
  File "C:\Users\susch\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\adapters\sql\connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
  File "C:\Users\susch\AppData\Local\Programs\Python\Python39\lib\site-packages\snowflake\connector\cursor.py", line 721, in execute
    Error.errorhandler_wrapper(
  File "C:\Users\susch\AppData\Local\Programs\Python\Python39\lib\site-packages\snowflake\connector\errors.py", line 258, in errorhandler_wrapper
    cursor.errorhandler(connection, cursor, error_class, error_value)
  File "C:\Users\susch\AppData\Local\Programs\Python\Python39\lib\site-packages\snowflake\connector\errors.py", line 188, in default_errorhandler
    raise error_class(
snowflake.connector.errors.ProgrammingError: 001003 (42000): SQL compilation error:
syntax error line 4 at position 0 unexpected 'use'.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\susch\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\task\base.py", line 348, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "C:\Users\susch\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\task\base.py", line 291, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "C:\Users\susch\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\task\base.py", line 393, in run
    return self.execute(compiled_node, manifest)
  File "C:\Users\susch\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\task\run.py", line 249, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "C:\Users\susch\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\clients\jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "C:\Users\susch\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\clients\jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "C:\Users\susch\AppData\Local\Programs\Python\Python39\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "C:\Users\susch\AppData\Local\Programs\Python\Python39\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 65, in macro
  File "C:\Users\susch\AppData\Local\Programs\Python\Python39\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "C:\Users\susch\AppData\Local\Programs\Python\Python39\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "C:\Users\susch\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\clients\jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "C:\Users\susch\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\clients\jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "C:\Users\susch\AppData\Local\Programs\Python\Python39\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "C:\Users\susch\AppData\Local\Programs\Python\Python39\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "C:\Users\susch\AppData\Local\Programs\Python\Python39\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "C:\Users\susch\AppData\Local\Programs\Python\Python39\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "C:\Users\susch\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\adapters\base\impl.py", line 226, in execute
    return self.connections.execute(
  File "C:\Users\susch\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\adapters\sql\connections.py", line 131, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "C:\Users\susch\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\adapters\snowflake\connections.py", line 354, in add_query
    connection, cursor = super().add_query(
  File "C:\Users\susch\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\adapters\sql\connections.py", line 87, in add_query
    return connection, cursor
  File "C:\Users\susch\AppData\Local\Programs\Python\Python39\lib\contextlib.py", line 137, in __exit__
    self.gen.throw(typ, value, traceback)
  File "C:\Users\susch\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\adapters\snowflake\connections.py", line 200, in exception_handler
    raise DatabaseException(msg)
dbt.exceptions.DatabaseException: Database Error in model CustomerDim (models\CustomerDim.sql)
  001003 (42000): SQL compilation error:
  syntax error line 4 at position 0 unexpected 'use'.
  compiled SQL at target\run\fullscript_takehome\models\CustomerDim.sql
2022-03-13 22:04:19.738901 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ffb7603c-ca8f-4fe3-9ef7-53463932d2f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029865AAAC70>]}
2022-03-13 22:04:19.739898 (Thread-1): 18:04:19 | 1 of 2 ERROR creating table model TPCH_SF1.CustomerDim............... [ERROR in 1.46s]
2022-03-13 22:04:19.741858 (Thread-1): Finished running node model.fullscript_takehome.CustomerDim
2022-03-13 22:04:19.784992 (Thread-2): Database Error in model OrdersFact (models\OrdersFact.sql)
  001003 (42000): SQL compilation error:
  syntax error line 4 at position 0 unexpected 'use'.
  compiled SQL at target\run\fullscript_takehome\models\OrdersFact.sql
Traceback (most recent call last):
  File "C:\Users\susch\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\adapters\snowflake\connections.py", line 183, in exception_handler
    yield
  File "C:\Users\susch\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\adapters\sql\connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
  File "C:\Users\susch\AppData\Local\Programs\Python\Python39\lib\site-packages\snowflake\connector\cursor.py", line 721, in execute
    Error.errorhandler_wrapper(
  File "C:\Users\susch\AppData\Local\Programs\Python\Python39\lib\site-packages\snowflake\connector\errors.py", line 258, in errorhandler_wrapper
    cursor.errorhandler(connection, cursor, error_class, error_value)
  File "C:\Users\susch\AppData\Local\Programs\Python\Python39\lib\site-packages\snowflake\connector\errors.py", line 188, in default_errorhandler
    raise error_class(
snowflake.connector.errors.ProgrammingError: 001003 (42000): SQL compilation error:
syntax error line 4 at position 0 unexpected 'use'.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\susch\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\task\base.py", line 348, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "C:\Users\susch\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\task\base.py", line 291, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "C:\Users\susch\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\task\base.py", line 393, in run
    return self.execute(compiled_node, manifest)
  File "C:\Users\susch\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\task\run.py", line 249, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "C:\Users\susch\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\clients\jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "C:\Users\susch\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\clients\jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "C:\Users\susch\AppData\Local\Programs\Python\Python39\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "C:\Users\susch\AppData\Local\Programs\Python\Python39\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 65, in macro
  File "C:\Users\susch\AppData\Local\Programs\Python\Python39\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "C:\Users\susch\AppData\Local\Programs\Python\Python39\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "C:\Users\susch\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\clients\jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "C:\Users\susch\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\clients\jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "C:\Users\susch\AppData\Local\Programs\Python\Python39\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "C:\Users\susch\AppData\Local\Programs\Python\Python39\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "C:\Users\susch\AppData\Local\Programs\Python\Python39\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "C:\Users\susch\AppData\Local\Programs\Python\Python39\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "C:\Users\susch\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\adapters\base\impl.py", line 226, in execute
    return self.connections.execute(
  File "C:\Users\susch\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\adapters\sql\connections.py", line 131, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "C:\Users\susch\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\adapters\snowflake\connections.py", line 354, in add_query
    connection, cursor = super().add_query(
  File "C:\Users\susch\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\adapters\sql\connections.py", line 87, in add_query
    return connection, cursor
  File "C:\Users\susch\AppData\Local\Programs\Python\Python39\lib\contextlib.py", line 137, in __exit__
    self.gen.throw(typ, value, traceback)
  File "C:\Users\susch\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\adapters\snowflake\connections.py", line 200, in exception_handler
    raise DatabaseException(msg)
dbt.exceptions.DatabaseException: Database Error in model OrdersFact (models\OrdersFact.sql)
  001003 (42000): SQL compilation error:
  syntax error line 4 at position 0 unexpected 'use'.
  compiled SQL at target\run\fullscript_takehome\models\OrdersFact.sql
2022-03-13 22:04:19.788981 (Thread-2): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ffb7603c-ca8f-4fe3-9ef7-53463932d2f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000298657CBF40>]}
2022-03-13 22:04:19.789979 (Thread-2): 18:04:19 | 2 of 2 ERROR creating table model TPCH_SF1.OrdersFact................ [ERROR in 1.51s]
2022-03-13 22:04:19.792940 (Thread-2): Finished running node model.fullscript_takehome.OrdersFact
2022-03-13 22:04:19.797924 (MainThread): Acquiring new snowflake connection "master".
2022-03-13 22:04:19.798956 (MainThread): 18:04:19 | 
2022-03-13 22:04:19.800913 (MainThread): 18:04:19 | Finished running 2 table models in 3.54s.
2022-03-13 22:04:19.801909 (MainThread): Connection 'master' was properly closed.
2022-03-13 22:04:19.802909 (MainThread): Connection 'list_SNOWFLAKE_SAMPLE_DATA' was properly closed.
2022-03-13 22:04:19.802909 (MainThread): Connection 'list_SNOWFLAKE_SAMPLE_DATA_TPCH_SF1' was properly closed.
2022-03-13 22:04:19.803903 (MainThread): Connection 'model.fullscript_takehome.CustomerDim' was properly closed.
2022-03-13 22:04:19.803903 (MainThread): Connection 'model.fullscript_takehome.OrdersFact' was properly closed.
2022-03-13 22:04:19.820896 (MainThread): 
2022-03-13 22:04:19.821893 (MainThread): Completed with 2 errors and 0 warnings:
2022-03-13 22:04:19.824852 (MainThread): 
2022-03-13 22:04:19.837820 (MainThread): Database Error in model CustomerDim (models\CustomerDim.sql)
2022-03-13 22:04:19.840808 (MainThread):   001003 (42000): SQL compilation error:
2022-03-13 22:04:19.851779 (MainThread):   syntax error line 4 at position 0 unexpected 'use'.
2022-03-13 22:04:19.853770 (MainThread):   compiled SQL at target\run\fullscript_takehome\models\CustomerDim.sql
2022-03-13 22:04:19.861756 (MainThread): 
2022-03-13 22:04:19.863745 (MainThread): Database Error in model OrdersFact (models\OrdersFact.sql)
2022-03-13 22:04:19.865740 (MainThread):   001003 (42000): SQL compilation error:
2022-03-13 22:04:19.866740 (MainThread):   syntax error line 4 at position 0 unexpected 'use'.
2022-03-13 22:04:19.867733 (MainThread):   compiled SQL at target\run\fullscript_takehome\models\OrdersFact.sql
2022-03-13 22:04:19.868732 (MainThread): 
Done. PASS=0 WARN=0 ERROR=2 SKIP=0 TOTAL=2
2022-03-13 22:04:19.870725 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000298659153D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000298657CB310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000298657CBF40>]}
2022-03-13 22:04:19.870725 (MainThread): Flushing usage events
2022-03-13 22:04:41.216151 (MainThread): Running with dbt=0.21.1
2022-03-13 22:04:41.927430 (MainThread): running dbt with arguments Namespace(record_timing_info=None, debug=False, log_format='default', write_json=True, use_colors=None, strict=False, warn_error=False, partial_parse=None, single_threaded=False, test_new_parser=False, use_experimental_parser=False, project_dir=None, profiles_dir='C:\\Users\\susch\\.dbt', profile=None, target=None, vars='{}', log_cache_events=False, use_cache=True, fail_fast=False, threads=None, version_check=True, select=None, exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
2022-03-13 22:04:41.927430 (MainThread): Tracking: tracking
2022-03-13 22:04:41.927430 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000214BD7C69D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000214BED3C070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000214BED3C970>]}
2022-03-13 22:04:41.936409 (MainThread): Partial parsing not enabled
2022-03-13 22:04:41.964360 (MainThread): Parsing macros\adapters.sql
2022-03-13 22:04:42.033148 (MainThread): Parsing macros\catalog.sql
2022-03-13 22:04:42.037138 (MainThread): Parsing macros\materializations\incremental.sql
2022-03-13 22:04:42.059086 (MainThread): Parsing macros\materializations\merge.sql
2022-03-13 22:04:42.066060 (MainThread): Parsing macros\materializations\seed.sql
2022-03-13 22:04:42.074039 (MainThread): Parsing macros\materializations\table.sql
2022-03-13 22:04:42.079026 (MainThread): Parsing macros\materializations\view.sql
2022-03-13 22:04:42.081020 (MainThread): Parsing macros\core.sql
2022-03-13 22:04:42.085011 (MainThread): Parsing macros\adapters\common.sql
2022-03-13 22:04:42.174769 (MainThread): Parsing macros\etc\datetime.sql
2022-03-13 22:04:42.186759 (MainThread): Parsing macros\etc\get_custom_alias.sql
2022-03-13 22:04:42.188765 (MainThread): Parsing macros\etc\get_custom_database.sql
2022-03-13 22:04:42.189763 (MainThread): Parsing macros\etc\get_custom_schema.sql
2022-03-13 22:04:42.192729 (MainThread): Parsing macros\etc\is_incremental.sql
2022-03-13 22:04:42.194716 (MainThread): Parsing macros\etc\query.sql
2022-03-13 22:04:42.195717 (MainThread): Parsing macros\etc\where_subquery.sql
2022-03-13 22:04:42.197718 (MainThread): Parsing macros\materializations\helpers.sql
2022-03-13 22:04:42.208679 (MainThread): Parsing macros\materializations\test.sql
2022-03-13 22:04:42.215692 (MainThread): Parsing macros\materializations\common\merge.sql
2022-03-13 22:04:42.228663 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2022-03-13 22:04:42.231622 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2022-03-13 22:04:42.241619 (MainThread): Parsing macros\materializations\incremental\on_schema_change.sql
2022-03-13 22:04:42.260572 (MainThread): Parsing macros\materializations\seed\seed.sql
2022-03-13 22:04:42.283509 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2022-03-13 22:04:42.315425 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2022-03-13 22:04:42.316418 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2022-03-13 22:04:42.335339 (MainThread): Parsing macros\materializations\table\table.sql
2022-03-13 22:04:42.342328 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2022-03-13 22:04:42.346312 (MainThread): Parsing macros\materializations\view\view.sql
2022-03-13 22:04:42.353291 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2022-03-13 22:04:42.355292 (MainThread): Parsing macros\schema_tests\not_null.sql
2022-03-13 22:04:42.356283 (MainThread): Parsing macros\schema_tests\relationships.sql
2022-03-13 22:04:42.358278 (MainThread): Parsing macros\schema_tests\unique.sql
2022-03-13 22:04:42.559768 (MainThread): Acquiring new snowflake connection "model.fullscript_takehome.CustomerDim".
2022-03-13 22:04:42.572732 (MainThread): Acquiring new snowflake connection "model.fullscript_takehome.OrdersFact".
2022-03-13 22:04:42.589689 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.fullscript_takehome.example

2022-03-13 22:04:42.595643 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8e0ebf79-d452-4349-ada3-094dda31e31c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000214BEE7EC10>]}
2022-03-13 22:04:42.629578 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2022-03-13 22:04:42.629578 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8e0ebf79-d452-4349-ada3-094dda31e31c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000214BECAF220>]}
2022-03-13 22:04:42.629578 (MainThread): Found 2 models, 0 tests, 0 snapshots, 0 analyses, 172 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2022-03-13 22:04:42.630578 (MainThread): 
2022-03-13 22:04:42.631576 (MainThread): Acquiring new snowflake connection "master".
2022-03-13 22:04:42.632545 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_SNOWFLAKE_SAMPLE_DATA".
2022-03-13 22:04:42.654515 (ThreadPoolExecutor-0_0): Using snowflake connection "list_SNOWFLAKE_SAMPLE_DATA".
2022-03-13 22:04:42.654515 (ThreadPoolExecutor-0_0): On list_SNOWFLAKE_SAMPLE_DATA: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "snowflakedb", "target_name": "prod", "connection_name": "list_SNOWFLAKE_SAMPLE_DATA"} */

    show terse schemas in database SNOWFLAKE_SAMPLE_DATA
    limit 10000
2022-03-13 22:04:42.655512 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2022-03-13 22:04:43.438150 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 8 in 0.78 seconds
2022-03-13 22:04:43.440147 (ThreadPoolExecutor-0_0): On list_SNOWFLAKE_SAMPLE_DATA: Close
2022-03-13 22:04:43.650373 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_SNOWFLAKE_SAMPLE_DATA_TPCH_SF1".
2022-03-13 22:04:43.658353 (ThreadPoolExecutor-1_0): Using snowflake connection "list_SNOWFLAKE_SAMPLE_DATA_TPCH_SF1".
2022-03-13 22:04:43.659349 (ThreadPoolExecutor-1_0): On list_SNOWFLAKE_SAMPLE_DATA_TPCH_SF1: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "snowflakedb", "target_name": "prod", "connection_name": "list_SNOWFLAKE_SAMPLE_DATA_TPCH_SF1"} */

    show terse objects in SNOWFLAKE_SAMPLE_DATA.TPCH_SF1
2022-03-13 22:04:43.659349 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2022-03-13 22:04:44.380640 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 8 in 0.72 seconds
2022-03-13 22:04:44.386642 (ThreadPoolExecutor-1_0): On list_SNOWFLAKE_SAMPLE_DATA_TPCH_SF1: Close
2022-03-13 22:04:44.526427 (MainThread): 18:04:44 | Concurrency: 10 threads (target='prod')
2022-03-13 22:04:44.526427 (MainThread): 18:04:44 | 
2022-03-13 22:04:44.530404 (Thread-1): Began running node model.fullscript_takehome.CustomerDim
2022-03-13 22:04:44.530404 (Thread-2): Began running node model.fullscript_takehome.OrdersFact
2022-03-13 22:04:44.530404 (Thread-1): 18:04:44 | 1 of 2 START table model TPCH_SF1.CustomerDim........................ [RUN]
2022-03-13 22:04:44.531429 (Thread-2): 18:04:44 | 2 of 2 START table model TPCH_SF1.OrdersFact......................... [RUN]
2022-03-13 22:04:44.531429 (Thread-1): Acquiring new snowflake connection "model.fullscript_takehome.CustomerDim".
2022-03-13 22:04:44.531429 (Thread-1): Compiling model.fullscript_takehome.CustomerDim
2022-03-13 22:04:44.532429 (Thread-2): Acquiring new snowflake connection "model.fullscript_takehome.OrdersFact".
2022-03-13 22:04:44.534396 (Thread-1): Writing injected SQL for node "model.fullscript_takehome.CustomerDim"
2022-03-13 22:04:44.535186 (Thread-2): Compiling model.fullscript_takehome.OrdersFact
2022-03-13 22:04:44.536404 (Thread-2): Writing injected SQL for node "model.fullscript_takehome.OrdersFact"
2022-03-13 22:04:44.537375 (Thread-1): finished collecting timing info
2022-03-13 22:04:44.549344 (Thread-2): finished collecting timing info
2022-03-13 22:04:44.562310 (Thread-1): Writing runtime SQL for node "model.fullscript_takehome.CustomerDim"
2022-03-13 22:04:44.563334 (Thread-2): Writing runtime SQL for node "model.fullscript_takehome.OrdersFact"
2022-03-13 22:04:44.566299 (Thread-1): Using snowflake connection "model.fullscript_takehome.CustomerDim".
2022-03-13 22:04:44.566299 (Thread-2): Using snowflake connection "model.fullscript_takehome.OrdersFact".
2022-03-13 22:04:44.566299 (Thread-1): On model.fullscript_takehome.CustomerDim: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "snowflakedb", "target_name": "prod", "node_id": "model.fullscript_takehome.CustomerDim"} */


      create or replace transient table SNOWFLAKE_SAMPLE_DATA.TPCH_SF1.CustomerDim  as
      ( 

with customer_dim as (

    SELECT CUSTOMER.C_CUSTKEY
    , CUSTOMER.C_NAME AS CUSTOMERNC_AME
    , CUSTOMER.C_ADDRESS AS CUSTOMERAC_DDRESS
    , NATION.N_NAME AS NATIONNAME
    , REGION.R_NAME AS REGIONNAME
    , CUSTOMER.C_PHONE AS CUSTOMERPC_HONE
    , CUSTOMER.C_ACCTBAL AS CUSTOMERAC_CCTBAL
    , CUSTOMER.C_MKTSEGMENT AS CUSTOMERMC_KTSEGMENT
    , CUSTOMER.C_COMMENT AS CUSTOMERCC_OMMENT    
    FROM CUSTOMER  
    LEFT join NATION  ON CUSTOMER.C_NATIONKEY  = NATION.N_NATIONKEY
    LEFT JOIN REGION  ON NATION.N_REGIONKEY = REGION.R_REGIONKEY 

)

select *
from customer_dim
      );
2022-03-13 22:04:44.567296 (Thread-2): On model.fullscript_takehome.OrdersFact: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "snowflakedb", "target_name": "prod", "node_id": "model.fullscript_takehome.OrdersFact"} */


      create or replace transient table SNOWFLAKE_SAMPLE_DATA.TPCH_SF1.OrdersFact  as
      (

with orders_fact as (

    select o_custkey, 
    o_orderstatus, 
    o_orderpriority, 
    o_orderdate,
    o_shippriority, 
    sum(o_totalprice) as totalprice
    from orders
    group by o_custkey
    , o_orderstatus
    , o_orderpriority
    , o_orderdate
    , o_shippriority

)

select *
from orders_fact
      );
2022-03-13 22:04:44.567296 (Thread-1): Opening a new connection, currently in state init
2022-03-13 22:04:44.567296 (Thread-2): Opening a new connection, currently in state init
2022-03-13 22:04:45.419728 (Thread-2): Snowflake query id: 01a2e82c-0000-4558-0000-00014d8a625d
2022-03-13 22:04:45.419728 (Thread-2): Snowflake error: 003540 (42501): SQL execution error: Creating table on shared database 'SNOWFLAKE_SAMPLE_DATA' is not allowed.
2022-03-13 22:04:45.420725 (Thread-2): finished collecting timing info
2022-03-13 22:04:45.421722 (Thread-2): On model.fullscript_takehome.OrdersFact: Close
2022-03-13 22:04:45.503701 (Thread-1): Snowflake query id: 01a2e82c-0000-4559-0000-00014d8a427d
2022-03-13 22:04:45.503701 (Thread-1): Snowflake error: 003540 (42501): SQL execution error: Creating table on shared database 'SNOWFLAKE_SAMPLE_DATA' is not allowed.
2022-03-13 22:04:45.504699 (Thread-1): finished collecting timing info
2022-03-13 22:04:45.504699 (Thread-1): On model.fullscript_takehome.CustomerDim: Close
2022-03-13 22:04:45.547586 (Thread-1): unclosed <socket.socket fd=1288, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.16', 56556), raddr=('52.228.75.102', 443)>
2022-03-13 22:04:45.549588 (Thread-2): Database Error in model OrdersFact (models\OrdersFact.sql)
  003540 (42501): SQL execution error: Creating table on shared database 'SNOWFLAKE_SAMPLE_DATA' is not allowed.
  compiled SQL at target\run\fullscript_takehome\models\OrdersFact.sql
Traceback (most recent call last):
  File "C:\Users\susch\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\adapters\snowflake\connections.py", line 183, in exception_handler
    yield
  File "C:\Users\susch\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\adapters\sql\connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
  File "C:\Users\susch\AppData\Local\Programs\Python\Python39\lib\site-packages\snowflake\connector\cursor.py", line 721, in execute
    Error.errorhandler_wrapper(
  File "C:\Users\susch\AppData\Local\Programs\Python\Python39\lib\site-packages\snowflake\connector\errors.py", line 258, in errorhandler_wrapper
    cursor.errorhandler(connection, cursor, error_class, error_value)
  File "C:\Users\susch\AppData\Local\Programs\Python\Python39\lib\site-packages\snowflake\connector\errors.py", line 188, in default_errorhandler
    raise error_class(
snowflake.connector.errors.ProgrammingError: 003540 (42501): SQL execution error: Creating table on shared database 'SNOWFLAKE_SAMPLE_DATA' is not allowed.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\susch\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\task\base.py", line 348, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "C:\Users\susch\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\task\base.py", line 291, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "C:\Users\susch\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\task\base.py", line 393, in run
    return self.execute(compiled_node, manifest)
  File "C:\Users\susch\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\task\run.py", line 249, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "C:\Users\susch\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\clients\jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "C:\Users\susch\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\clients\jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "C:\Users\susch\AppData\Local\Programs\Python\Python39\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "C:\Users\susch\AppData\Local\Programs\Python\Python39\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 65, in macro
  File "C:\Users\susch\AppData\Local\Programs\Python\Python39\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "C:\Users\susch\AppData\Local\Programs\Python\Python39\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "C:\Users\susch\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\clients\jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "C:\Users\susch\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\clients\jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "C:\Users\susch\AppData\Local\Programs\Python\Python39\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "C:\Users\susch\AppData\Local\Programs\Python\Python39\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "C:\Users\susch\AppData\Local\Programs\Python\Python39\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "C:\Users\susch\AppData\Local\Programs\Python\Python39\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "C:\Users\susch\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\adapters\base\impl.py", line 226, in execute
    return self.connections.execute(
  File "C:\Users\susch\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\adapters\sql\connections.py", line 131, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "C:\Users\susch\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\adapters\snowflake\connections.py", line 354, in add_query
    connection, cursor = super().add_query(
  File "C:\Users\susch\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\adapters\sql\connections.py", line 87, in add_query
    return connection, cursor
  File "C:\Users\susch\AppData\Local\Programs\Python\Python39\lib\contextlib.py", line 137, in __exit__
    self.gen.throw(typ, value, traceback)
  File "C:\Users\susch\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\adapters\snowflake\connections.py", line 200, in exception_handler
    raise DatabaseException(msg)
dbt.exceptions.DatabaseException: Database Error in model OrdersFact (models\OrdersFact.sql)
  003540 (42501): SQL execution error: Creating table on shared database 'SNOWFLAKE_SAMPLE_DATA' is not allowed.
  compiled SQL at target\run\fullscript_takehome\models\OrdersFact.sql
2022-03-13 22:04:45.572518 (Thread-2): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8e0ebf79-d452-4349-ada3-094dda31e31c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000214BF121A00>]}
2022-03-13 22:04:45.573513 (Thread-2): 18:04:45 | 2 of 2 ERROR creating table model TPCH_SF1.OrdersFact................ [ERROR in 1.04s]
2022-03-13 22:04:45.576514 (Thread-2): Finished running node model.fullscript_takehome.OrdersFact
2022-03-13 22:04:45.919916 (Thread-1): Database Error in model CustomerDim (models\CustomerDim.sql)
  003540 (42501): SQL execution error: Creating table on shared database 'SNOWFLAKE_SAMPLE_DATA' is not allowed.
  compiled SQL at target\run\fullscript_takehome\models\CustomerDim.sql
Traceback (most recent call last):
  File "C:\Users\susch\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\adapters\snowflake\connections.py", line 183, in exception_handler
    yield
  File "C:\Users\susch\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\adapters\sql\connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
  File "C:\Users\susch\AppData\Local\Programs\Python\Python39\lib\site-packages\snowflake\connector\cursor.py", line 721, in execute
    Error.errorhandler_wrapper(
  File "C:\Users\susch\AppData\Local\Programs\Python\Python39\lib\site-packages\snowflake\connector\errors.py", line 258, in errorhandler_wrapper
    cursor.errorhandler(connection, cursor, error_class, error_value)
  File "C:\Users\susch\AppData\Local\Programs\Python\Python39\lib\site-packages\snowflake\connector\errors.py", line 188, in default_errorhandler
    raise error_class(
snowflake.connector.errors.ProgrammingError: 003540 (42501): SQL execution error: Creating table on shared database 'SNOWFLAKE_SAMPLE_DATA' is not allowed.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\susch\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\task\base.py", line 348, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "C:\Users\susch\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\task\base.py", line 291, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "C:\Users\susch\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\task\base.py", line 393, in run
    return self.execute(compiled_node, manifest)
  File "C:\Users\susch\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\task\run.py", line 249, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "C:\Users\susch\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\clients\jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "C:\Users\susch\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\clients\jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "C:\Users\susch\AppData\Local\Programs\Python\Python39\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "C:\Users\susch\AppData\Local\Programs\Python\Python39\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 65, in macro
  File "C:\Users\susch\AppData\Local\Programs\Python\Python39\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "C:\Users\susch\AppData\Local\Programs\Python\Python39\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "C:\Users\susch\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\clients\jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "C:\Users\susch\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\clients\jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "C:\Users\susch\AppData\Local\Programs\Python\Python39\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "C:\Users\susch\AppData\Local\Programs\Python\Python39\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "C:\Users\susch\AppData\Local\Programs\Python\Python39\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "C:\Users\susch\AppData\Local\Programs\Python\Python39\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "C:\Users\susch\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\adapters\base\impl.py", line 226, in execute
    return self.connections.execute(
  File "C:\Users\susch\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\adapters\sql\connections.py", line 131, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "C:\Users\susch\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\adapters\snowflake\connections.py", line 354, in add_query
    connection, cursor = super().add_query(
  File "C:\Users\susch\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\adapters\sql\connections.py", line 87, in add_query
    return connection, cursor
  File "C:\Users\susch\AppData\Local\Programs\Python\Python39\lib\contextlib.py", line 137, in __exit__
    self.gen.throw(typ, value, traceback)
  File "C:\Users\susch\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\adapters\snowflake\connections.py", line 200, in exception_handler
    raise DatabaseException(msg)
dbt.exceptions.DatabaseException: Database Error in model CustomerDim (models\CustomerDim.sql)
  003540 (42501): SQL execution error: Creating table on shared database 'SNOWFLAKE_SAMPLE_DATA' is not allowed.
  compiled SQL at target\run\fullscript_takehome\models\CustomerDim.sql
2022-03-13 22:04:45.923904 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8e0ebf79-d452-4349-ada3-094dda31e31c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000214BF03B9A0>]}
2022-03-13 22:04:45.924903 (Thread-1): 18:04:45 | 1 of 2 ERROR creating table model TPCH_SF1.CustomerDim............... [ERROR in 1.39s]
2022-03-13 22:04:45.927439 (Thread-1): Finished running node model.fullscript_takehome.CustomerDim
2022-03-13 22:04:45.931437 (MainThread): Acquiring new snowflake connection "master".
2022-03-13 22:04:45.932469 (MainThread): 18:04:45 | 
2022-03-13 22:04:45.933458 (MainThread): 18:04:45 | Finished running 2 table models in 3.30s.
2022-03-13 22:04:45.934997 (MainThread): Connection 'master' was properly closed.
2022-03-13 22:04:45.934997 (MainThread): Connection 'list_SNOWFLAKE_SAMPLE_DATA' was properly closed.
2022-03-13 22:04:45.936030 (MainThread): Connection 'list_SNOWFLAKE_SAMPLE_DATA_TPCH_SF1' was properly closed.
2022-03-13 22:04:45.936030 (MainThread): Connection 'model.fullscript_takehome.CustomerDim' was properly closed.
2022-03-13 22:04:45.937030 (MainThread): Connection 'model.fullscript_takehome.OrdersFact' was properly closed.
2022-03-13 22:04:45.953956 (MainThread): 
2022-03-13 22:04:45.955200 (MainThread): Completed with 2 errors and 0 warnings:
2022-03-13 22:04:45.956945 (MainThread): 
2022-03-13 22:04:45.957948 (MainThread): Database Error in model OrdersFact (models\OrdersFact.sql)
2022-03-13 22:04:45.959872 (MainThread):   003540 (42501): SQL execution error: Creating table on shared database 'SNOWFLAKE_SAMPLE_DATA' is not allowed.
2022-03-13 22:04:45.960878 (MainThread):   compiled SQL at target\run\fullscript_takehome\models\OrdersFact.sql
2022-03-13 22:04:45.961873 (MainThread): 
2022-03-13 22:04:45.962873 (MainThread): Database Error in model CustomerDim (models\CustomerDim.sql)
2022-03-13 22:04:45.963871 (MainThread):   003540 (42501): SQL execution error: Creating table on shared database 'SNOWFLAKE_SAMPLE_DATA' is not allowed.
2022-03-13 22:04:45.966863 (MainThread):   compiled SQL at target\run\fullscript_takehome\models\CustomerDim.sql
2022-03-13 22:04:45.967856 (MainThread): 
Done. PASS=0 WARN=0 ERROR=2 SKIP=0 TOTAL=2
2022-03-13 22:04:45.967856 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000214BF00E6D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000214BED99C10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000214BECAFD30>]}
2022-03-13 22:04:45.968873 (MainThread): Flushing usage events
2022-03-13 22:05:00.160710 (MainThread): Running with dbt=0.21.1
2022-03-13 22:05:00.957947 (MainThread): running dbt with arguments Namespace(record_timing_info=None, debug=False, log_format='default', write_json=True, use_colors=None, strict=False, warn_error=False, partial_parse=None, single_threaded=False, test_new_parser=False, use_experimental_parser=False, project_dir=None, profiles_dir='C:\\Users\\susch\\.dbt', profile=None, target=None, vars='{}', log_cache_events=False, use_cache=True, fail_fast=False, threads=None, version_check=True, select=None, exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
2022-03-13 22:05:00.958944 (MainThread): Tracking: tracking
2022-03-13 22:05:00.958944 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024EE8A656A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024EE9FCCE20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024EE9FCC820>]}
2022-03-13 22:05:00.969915 (MainThread): Partial parsing not enabled
2022-03-13 22:05:00.998838 (MainThread): Parsing macros\adapters.sql
2022-03-13 22:05:01.029756 (MainThread): Parsing macros\catalog.sql
2022-03-13 22:05:01.031750 (MainThread): Parsing macros\materializations\incremental.sql
2022-03-13 22:05:01.039729 (MainThread): Parsing macros\materializations\merge.sql
2022-03-13 22:05:01.043718 (MainThread): Parsing macros\materializations\seed.sql
2022-03-13 22:05:01.046710 (MainThread): Parsing macros\materializations\table.sql
2022-03-13 22:05:01.049702 (MainThread): Parsing macros\materializations\view.sql
2022-03-13 22:05:01.050699 (MainThread): Parsing macros\core.sql
2022-03-13 22:05:01.054689 (MainThread): Parsing macros\adapters\common.sql
2022-03-13 22:05:01.148440 (MainThread): Parsing macros\etc\datetime.sql
2022-03-13 22:05:01.170414 (MainThread): Parsing macros\etc\get_custom_alias.sql
2022-03-13 22:05:01.174376 (MainThread): Parsing macros\etc\get_custom_database.sql
2022-03-13 22:05:01.177394 (MainThread): Parsing macros\etc\get_custom_schema.sql
2022-03-13 22:05:01.180385 (MainThread): Parsing macros\etc\is_incremental.sql
2022-03-13 22:05:01.182348 (MainThread): Parsing macros\etc\query.sql
2022-03-13 22:05:01.183375 (MainThread): Parsing macros\etc\where_subquery.sql
2022-03-13 22:05:01.185369 (MainThread): Parsing macros\materializations\helpers.sql
2022-03-13 22:05:01.197309 (MainThread): Parsing macros\materializations\test.sql
2022-03-13 22:05:01.204319 (MainThread): Parsing macros\materializations\common\merge.sql
2022-03-13 22:05:01.218251 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2022-03-13 22:05:01.219249 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2022-03-13 22:05:01.227227 (MainThread): Parsing macros\materializations\incremental\on_schema_change.sql
2022-03-13 22:05:01.245212 (MainThread): Parsing macros\materializations\seed\seed.sql
2022-03-13 22:05:01.266152 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2022-03-13 22:05:01.293084 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2022-03-13 22:05:01.294082 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2022-03-13 22:05:01.310039 (MainThread): Parsing macros\materializations\table\table.sql
2022-03-13 22:05:01.316024 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2022-03-13 22:05:01.320014 (MainThread): Parsing macros\materializations\view\view.sql
2022-03-13 22:05:01.326962 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2022-03-13 22:05:01.328956 (MainThread): Parsing macros\schema_tests\not_null.sql
2022-03-13 22:05:01.329954 (MainThread): Parsing macros\schema_tests\relationships.sql
2022-03-13 22:05:01.331948 (MainThread): Parsing macros\schema_tests\unique.sql
2022-03-13 22:05:01.547399 (MainThread): Acquiring new snowflake connection "model.fullscript_takehome.CustomerDim".
2022-03-13 22:05:01.558346 (MainThread): Acquiring new snowflake connection "model.fullscript_takehome.OrdersFact".
2022-03-13 22:05:01.575298 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.fullscript_takehome.example

2022-03-13 22:05:01.580916 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c0b0271e-5e70-45d9-9a2d-207424a51e27', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024EEA10CBE0>]}
2022-03-13 22:05:01.615796 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2022-03-13 22:05:01.615796 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c0b0271e-5e70-45d9-9a2d-207424a51e27', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024EE9F3E070>]}
2022-03-13 22:05:01.616789 (MainThread): Found 2 models, 0 tests, 0 snapshots, 0 analyses, 172 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2022-03-13 22:05:01.617785 (MainThread): 
2022-03-13 22:05:01.618783 (MainThread): Acquiring new snowflake connection "master".
2022-03-13 22:05:01.619811 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_SNOWFLAKE_SAMPLE_DATA".
2022-03-13 22:05:01.630782 (ThreadPoolExecutor-0_0): Using snowflake connection "list_SNOWFLAKE_SAMPLE_DATA".
2022-03-13 22:05:01.631775 (ThreadPoolExecutor-0_0): On list_SNOWFLAKE_SAMPLE_DATA: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "snowflakedb", "target_name": "prod", "connection_name": "list_SNOWFLAKE_SAMPLE_DATA"} */

    show terse schemas in database SNOWFLAKE_SAMPLE_DATA
    limit 10000
2022-03-13 22:05:01.631775 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2022-03-13 22:05:02.439202 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 8 in 0.81 seconds
2022-03-13 22:05:02.441197 (ThreadPoolExecutor-0_0): On list_SNOWFLAKE_SAMPLE_DATA: Close
2022-03-13 22:05:02.577856 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_SNOWFLAKE_SAMPLE_DATA_TPCH_SF1".
2022-03-13 22:05:02.582843 (ThreadPoolExecutor-1_0): Using snowflake connection "list_SNOWFLAKE_SAMPLE_DATA_TPCH_SF1".
2022-03-13 22:05:02.582843 (ThreadPoolExecutor-1_0): On list_SNOWFLAKE_SAMPLE_DATA_TPCH_SF1: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "snowflakedb", "target_name": "prod", "connection_name": "list_SNOWFLAKE_SAMPLE_DATA_TPCH_SF1"} */

    show terse objects in SNOWFLAKE_SAMPLE_DATA.TPCH_SF1
2022-03-13 22:05:02.583841 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2022-03-13 22:05:03.118304 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 8 in 0.53 seconds
2022-03-13 22:05:03.123290 (ThreadPoolExecutor-1_0): On list_SNOWFLAKE_SAMPLE_DATA_TPCH_SF1: Close
2022-03-13 22:05:03.251171 (MainThread): 18:05:03 | Concurrency: 10 threads (target='prod')
2022-03-13 22:05:03.252168 (MainThread): 18:05:03 | 
2022-03-13 22:05:03.265138 (Thread-1): Began running node model.fullscript_takehome.CustomerDim
2022-03-13 22:05:03.266134 (Thread-2): Began running node model.fullscript_takehome.OrdersFact
2022-03-13 22:05:03.266134 (Thread-1): 18:05:03 | 1 of 2 START view model TPCH_SF1.CustomerDim......................... [RUN]
2022-03-13 22:05:03.267131 (Thread-2): 18:05:03 | 2 of 2 START view model TPCH_SF1.OrdersFact.......................... [RUN]
2022-03-13 22:05:03.268129 (Thread-1): Acquiring new snowflake connection "model.fullscript_takehome.CustomerDim".
2022-03-13 22:05:03.269122 (Thread-1): Compiling model.fullscript_takehome.CustomerDim
2022-03-13 22:05:03.270122 (Thread-2): Acquiring new snowflake connection "model.fullscript_takehome.OrdersFact".
2022-03-13 22:05:03.275110 (Thread-1): Writing injected SQL for node "model.fullscript_takehome.CustomerDim"
2022-03-13 22:05:03.275110 (Thread-2): Compiling model.fullscript_takehome.OrdersFact
2022-03-13 22:05:03.278100 (Thread-2): Writing injected SQL for node "model.fullscript_takehome.OrdersFact"
2022-03-13 22:05:03.279099 (Thread-1): finished collecting timing info
2022-03-13 22:05:03.286106 (Thread-2): finished collecting timing info
2022-03-13 22:05:03.307021 (Thread-1): Writing runtime SQL for node "model.fullscript_takehome.CustomerDim"
2022-03-13 22:05:03.309017 (Thread-2): Writing runtime SQL for node "model.fullscript_takehome.OrdersFact"
2022-03-13 22:05:03.310014 (Thread-1): Using snowflake connection "model.fullscript_takehome.CustomerDim".
2022-03-13 22:05:03.310014 (Thread-1): On model.fullscript_takehome.CustomerDim: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "snowflakedb", "target_name": "prod", "node_id": "model.fullscript_takehome.CustomerDim"} */

  create or replace  view SNOWFLAKE_SAMPLE_DATA.TPCH_SF1.CustomerDim  as (
     

with customer_dim as (

    SELECT CUSTOMER.C_CUSTKEY
    , CUSTOMER.C_NAME AS CUSTOMERNC_AME
    , CUSTOMER.C_ADDRESS AS CUSTOMERAC_DDRESS
    , NATION.N_NAME AS NATIONNAME
    , REGION.R_NAME AS REGIONNAME
    , CUSTOMER.C_PHONE AS CUSTOMERPC_HONE
    , CUSTOMER.C_ACCTBAL AS CUSTOMERAC_CCTBAL
    , CUSTOMER.C_MKTSEGMENT AS CUSTOMERMC_KTSEGMENT
    , CUSTOMER.C_COMMENT AS CUSTOMERCC_OMMENT    
    FROM CUSTOMER  
    LEFT join NATION  ON CUSTOMER.C_NATIONKEY  = NATION.N_NATIONKEY
    LEFT JOIN REGION  ON NATION.N_REGIONKEY = REGION.R_REGIONKEY 

)

select *
from customer_dim
  );
2022-03-13 22:05:03.311010 (Thread-1): Opening a new connection, currently in state init
2022-03-13 22:05:03.313018 (Thread-2): Using snowflake connection "model.fullscript_takehome.OrdersFact".
2022-03-13 22:05:03.313018 (Thread-2): On model.fullscript_takehome.OrdersFact: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "snowflakedb", "target_name": "prod", "node_id": "model.fullscript_takehome.OrdersFact"} */

  create or replace  view SNOWFLAKE_SAMPLE_DATA.TPCH_SF1.OrdersFact  as (
    

with orders_fact as (

    select o_custkey, 
    o_orderstatus, 
    o_orderpriority, 
    o_orderdate,
    o_shippriority, 
    sum(o_totalprice) as totalprice
    from orders
    group by o_custkey
    , o_orderstatus
    , o_orderpriority
    , o_orderdate
    , o_shippriority

)

select *
from orders_fact
  );
2022-03-13 22:05:03.313018 (Thread-2): Opening a new connection, currently in state init
2022-03-13 22:05:04.196725 (Thread-2): Snowflake query id: 01a2e82d-0000-4557-0000-00014d8a3109
2022-03-13 22:05:04.197721 (Thread-2): Snowflake error: 003540 (42501): SQL execution error: Creating view on shared database 'SNOWFLAKE_SAMPLE_DATA' is not allowed.
2022-03-13 22:05:04.199710 (Thread-2): finished collecting timing info
2022-03-13 22:05:04.200714 (Thread-1): Snowflake query id: 01a2e82d-0000-4557-0000-00014d8a310d
2022-03-13 22:05:04.201676 (Thread-2): On model.fullscript_takehome.OrdersFact: Close
2022-03-13 22:05:04.201676 (Thread-1): Snowflake error: 003540 (42501): SQL execution error: Creating view on shared database 'SNOWFLAKE_SAMPLE_DATA' is not allowed.
2022-03-13 22:05:04.205701 (Thread-1): finished collecting timing info
2022-03-13 22:05:04.207665 (Thread-1): On model.fullscript_takehome.CustomerDim: Close
2022-03-13 22:05:04.341480 (Thread-2): Database Error in model OrdersFact (models\OrdersFact.sql)
  003540 (42501): SQL execution error: Creating view on shared database 'SNOWFLAKE_SAMPLE_DATA' is not allowed.
  compiled SQL at target\run\fullscript_takehome\models\OrdersFact.sql
Traceback (most recent call last):
  File "C:\Users\susch\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\adapters\snowflake\connections.py", line 183, in exception_handler
    yield
  File "C:\Users\susch\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\adapters\sql\connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
  File "C:\Users\susch\AppData\Local\Programs\Python\Python39\lib\site-packages\snowflake\connector\cursor.py", line 721, in execute
    Error.errorhandler_wrapper(
  File "C:\Users\susch\AppData\Local\Programs\Python\Python39\lib\site-packages\snowflake\connector\errors.py", line 258, in errorhandler_wrapper
    cursor.errorhandler(connection, cursor, error_class, error_value)
  File "C:\Users\susch\AppData\Local\Programs\Python\Python39\lib\site-packages\snowflake\connector\errors.py", line 188, in default_errorhandler
    raise error_class(
snowflake.connector.errors.ProgrammingError: 003540 (42501): SQL execution error: Creating view on shared database 'SNOWFLAKE_SAMPLE_DATA' is not allowed.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\susch\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\task\base.py", line 348, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "C:\Users\susch\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\task\base.py", line 291, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "C:\Users\susch\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\task\base.py", line 393, in run
    return self.execute(compiled_node, manifest)
  File "C:\Users\susch\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\task\run.py", line 249, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "C:\Users\susch\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\clients\jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "C:\Users\susch\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\clients\jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "C:\Users\susch\AppData\Local\Programs\Python\Python39\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "C:\Users\susch\AppData\Local\Programs\Python\Python39\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 27, in macro
  File "C:\Users\susch\AppData\Local\Programs\Python\Python39\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "C:\Users\susch\AppData\Local\Programs\Python\Python39\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "C:\Users\susch\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\clients\jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "C:\Users\susch\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\clients\jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "C:\Users\susch\AppData\Local\Programs\Python\Python39\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "C:\Users\susch\AppData\Local\Programs\Python\Python39\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 55, in macro
  File "C:\Users\susch\AppData\Local\Programs\Python\Python39\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "C:\Users\susch\AppData\Local\Programs\Python\Python39\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "C:\Users\susch\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\clients\jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "C:\Users\susch\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\clients\jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "C:\Users\susch\AppData\Local\Programs\Python\Python39\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "C:\Users\susch\AppData\Local\Programs\Python\Python39\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "C:\Users\susch\AppData\Local\Programs\Python\Python39\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "C:\Users\susch\AppData\Local\Programs\Python\Python39\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "C:\Users\susch\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\adapters\base\impl.py", line 226, in execute
    return self.connections.execute(
  File "C:\Users\susch\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\adapters\sql\connections.py", line 131, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "C:\Users\susch\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\adapters\snowflake\connections.py", line 354, in add_query
    connection, cursor = super().add_query(
  File "C:\Users\susch\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\adapters\sql\connections.py", line 87, in add_query
    return connection, cursor
  File "C:\Users\susch\AppData\Local\Programs\Python\Python39\lib\contextlib.py", line 137, in __exit__
    self.gen.throw(typ, value, traceback)
  File "C:\Users\susch\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\adapters\snowflake\connections.py", line 200, in exception_handler
    raise DatabaseException(msg)
dbt.exceptions.DatabaseException: Database Error in model OrdersFact (models\OrdersFact.sql)
  003540 (42501): SQL execution error: Creating view on shared database 'SNOWFLAKE_SAMPLE_DATA' is not allowed.
  compiled SQL at target\run\fullscript_takehome\models\OrdersFact.sql
2022-03-13 22:05:04.345500 (Thread-2): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c0b0271e-5e70-45d9-9a2d-207424a51e27', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024EEA3B2A30>]}
2022-03-13 22:05:04.346470 (Thread-2): 18:05:04 | 2 of 2 ERROR creating view model TPCH_SF1.OrdersFact................. [ERROR in 1.08s]
2022-03-13 22:05:04.348462 (Thread-2): Finished running node model.fullscript_takehome.OrdersFact
2022-03-13 22:05:04.344474 (Thread-1): Database Error in model CustomerDim (models\CustomerDim.sql)
  003540 (42501): SQL execution error: Creating view on shared database 'SNOWFLAKE_SAMPLE_DATA' is not allowed.
  compiled SQL at target\run\fullscript_takehome\models\CustomerDim.sql
Traceback (most recent call last):
  File "C:\Users\susch\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\adapters\snowflake\connections.py", line 183, in exception_handler
    yield
  File "C:\Users\susch\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\adapters\sql\connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
  File "C:\Users\susch\AppData\Local\Programs\Python\Python39\lib\site-packages\snowflake\connector\cursor.py", line 721, in execute
    Error.errorhandler_wrapper(
  File "C:\Users\susch\AppData\Local\Programs\Python\Python39\lib\site-packages\snowflake\connector\errors.py", line 258, in errorhandler_wrapper
    cursor.errorhandler(connection, cursor, error_class, error_value)
  File "C:\Users\susch\AppData\Local\Programs\Python\Python39\lib\site-packages\snowflake\connector\errors.py", line 188, in default_errorhandler
    raise error_class(
snowflake.connector.errors.ProgrammingError: 003540 (42501): SQL execution error: Creating view on shared database 'SNOWFLAKE_SAMPLE_DATA' is not allowed.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\susch\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\task\base.py", line 348, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "C:\Users\susch\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\task\base.py", line 291, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "C:\Users\susch\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\task\base.py", line 393, in run
    return self.execute(compiled_node, manifest)
  File "C:\Users\susch\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\task\run.py", line 249, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "C:\Users\susch\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\clients\jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "C:\Users\susch\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\clients\jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "C:\Users\susch\AppData\Local\Programs\Python\Python39\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "C:\Users\susch\AppData\Local\Programs\Python\Python39\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 27, in macro
  File "C:\Users\susch\AppData\Local\Programs\Python\Python39\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "C:\Users\susch\AppData\Local\Programs\Python\Python39\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "C:\Users\susch\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\clients\jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "C:\Users\susch\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\clients\jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "C:\Users\susch\AppData\Local\Programs\Python\Python39\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "C:\Users\susch\AppData\Local\Programs\Python\Python39\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 55, in macro
  File "C:\Users\susch\AppData\Local\Programs\Python\Python39\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "C:\Users\susch\AppData\Local\Programs\Python\Python39\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "C:\Users\susch\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\clients\jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "C:\Users\susch\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\clients\jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "C:\Users\susch\AppData\Local\Programs\Python\Python39\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "C:\Users\susch\AppData\Local\Programs\Python\Python39\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "C:\Users\susch\AppData\Local\Programs\Python\Python39\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "C:\Users\susch\AppData\Local\Programs\Python\Python39\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "C:\Users\susch\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\adapters\base\impl.py", line 226, in execute
    return self.connections.execute(
  File "C:\Users\susch\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\adapters\sql\connections.py", line 131, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "C:\Users\susch\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\adapters\snowflake\connections.py", line 354, in add_query
    connection, cursor = super().add_query(
  File "C:\Users\susch\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\adapters\sql\connections.py", line 87, in add_query
    return connection, cursor
  File "C:\Users\susch\AppData\Local\Programs\Python\Python39\lib\contextlib.py", line 137, in __exit__
    self.gen.throw(typ, value, traceback)
  File "C:\Users\susch\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\adapters\snowflake\connections.py", line 200, in exception_handler
    raise DatabaseException(msg)
dbt.exceptions.DatabaseException: Database Error in model CustomerDim (models\CustomerDim.sql)
  003540 (42501): SQL execution error: Creating view on shared database 'SNOWFLAKE_SAMPLE_DATA' is not allowed.
  compiled SQL at target\run\fullscript_takehome\models\CustomerDim.sql
2022-03-13 22:05:04.349463 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c0b0271e-5e70-45d9-9a2d-207424a51e27', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024EEA2CC9D0>]}
2022-03-13 22:05:04.350486 (Thread-1): 18:05:04 | 1 of 2 ERROR creating view model TPCH_SF1.CustomerDim................ [ERROR in 1.08s]
2022-03-13 22:05:04.351455 (Thread-1): Finished running node model.fullscript_takehome.CustomerDim
2022-03-13 22:05:04.354446 (MainThread): Acquiring new snowflake connection "master".
2022-03-13 22:05:04.355443 (MainThread): 18:05:04 | 
2022-03-13 22:05:04.356444 (MainThread): 18:05:04 | Finished running 2 view models in 2.74s.
2022-03-13 22:05:04.357440 (MainThread): Connection 'master' was properly closed.
2022-03-13 22:05:04.357440 (MainThread): Connection 'list_SNOWFLAKE_SAMPLE_DATA' was properly closed.
2022-03-13 22:05:04.357440 (MainThread): Connection 'list_SNOWFLAKE_SAMPLE_DATA_TPCH_SF1' was properly closed.
2022-03-13 22:05:04.358436 (MainThread): Connection 'model.fullscript_takehome.CustomerDim' was properly closed.
2022-03-13 22:05:04.358436 (MainThread): Connection 'model.fullscript_takehome.OrdersFact' was properly closed.
2022-03-13 22:05:04.372399 (MainThread): 
2022-03-13 22:05:04.373396 (MainThread): Completed with 2 errors and 0 warnings:
2022-03-13 22:05:04.374392 (MainThread): 
2022-03-13 22:05:04.378384 (MainThread): Database Error in model OrdersFact (models\OrdersFact.sql)
2022-03-13 22:05:04.381376 (MainThread):   003540 (42501): SQL execution error: Creating view on shared database 'SNOWFLAKE_SAMPLE_DATA' is not allowed.
2022-03-13 22:05:04.385365 (MainThread):   compiled SQL at target\run\fullscript_takehome\models\OrdersFact.sql
2022-03-13 22:05:04.386361 (MainThread): 
2022-03-13 22:05:04.387359 (MainThread): Database Error in model CustomerDim (models\CustomerDim.sql)
2022-03-13 22:05:04.388354 (MainThread):   003540 (42501): SQL execution error: Creating view on shared database 'SNOWFLAKE_SAMPLE_DATA' is not allowed.
2022-03-13 22:05:04.389354 (MainThread):   compiled SQL at target\run\fullscript_takehome\models\CustomerDim.sql
2022-03-13 22:05:04.389354 (MainThread): 
Done. PASS=0 WARN=0 ERROR=2 SKIP=0 TOTAL=2
2022-03-13 22:05:04.390350 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024EEA2CC9D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024EEA24B220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024EEA24B040>]}
2022-03-13 22:05:04.391347 (MainThread): Flushing usage events
2022-03-13 22:05:25.045515 (MainThread): Running with dbt=0.21.1
2022-03-13 22:05:25.732677 (MainThread): running dbt with arguments Namespace(record_timing_info=None, debug=False, log_format='default', write_json=True, use_colors=None, strict=False, warn_error=False, partial_parse=None, single_threaded=False, test_new_parser=False, use_experimental_parser=False, project_dir=None, profiles_dir='C:\\Users\\susch\\.dbt', profile=None, target=None, vars='{}', log_cache_events=False, use_cache=True, fail_fast=False, threads=None, version_check=True, select=None, exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
2022-03-13 22:05:25.732677 (MainThread): Tracking: tracking
2022-03-13 22:05:25.732677 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018D61F653A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018D634EE5E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018D634EE220>]}
2022-03-13 22:05:25.741654 (MainThread): Partial parsing not enabled
2022-03-13 22:05:25.783569 (MainThread): Parsing macros\adapters.sql
2022-03-13 22:05:25.815492 (MainThread): Parsing macros\catalog.sql
2022-03-13 22:05:25.816486 (MainThread): Parsing macros\materializations\incremental.sql
2022-03-13 22:05:25.826456 (MainThread): Parsing macros\materializations\merge.sql
2022-03-13 22:05:25.830443 (MainThread): Parsing macros\materializations\seed.sql
2022-03-13 22:05:25.834437 (MainThread): Parsing macros\materializations\table.sql
2022-03-13 22:05:25.837396 (MainThread): Parsing macros\materializations\view.sql
2022-03-13 22:05:25.838394 (MainThread): Parsing macros\core.sql
2022-03-13 22:05:25.841386 (MainThread): Parsing macros\adapters\common.sql
2022-03-13 22:05:25.892279 (MainThread): Parsing macros\etc\datetime.sql
2022-03-13 22:05:25.900256 (MainThread): Parsing macros\etc\get_custom_alias.sql
2022-03-13 22:05:25.901258 (MainThread): Parsing macros\etc\get_custom_database.sql
2022-03-13 22:05:25.902251 (MainThread): Parsing macros\etc\get_custom_schema.sql
2022-03-13 22:05:25.905243 (MainThread): Parsing macros\etc\is_incremental.sql
2022-03-13 22:05:25.906243 (MainThread): Parsing macros\etc\query.sql
2022-03-13 22:05:25.907239 (MainThread): Parsing macros\etc\where_subquery.sql
2022-03-13 22:05:25.908235 (MainThread): Parsing macros\materializations\helpers.sql
2022-03-13 22:05:25.917217 (MainThread): Parsing macros\materializations\test.sql
2022-03-13 22:05:25.923202 (MainThread): Parsing macros\materializations\common\merge.sql
2022-03-13 22:05:25.936165 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2022-03-13 22:05:25.937163 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2022-03-13 22:05:25.947136 (MainThread): Parsing macros\materializations\incremental\on_schema_change.sql
2022-03-13 22:05:25.964069 (MainThread): Parsing macros\materializations\seed\seed.sql
2022-03-13 22:05:25.991984 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2022-03-13 22:05:26.018943 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2022-03-13 22:05:26.020939 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2022-03-13 22:05:26.035898 (MainThread): Parsing macros\materializations\table\table.sql
2022-03-13 22:05:26.042880 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2022-03-13 22:05:26.046869 (MainThread): Parsing macros\materializations\view\view.sql
2022-03-13 22:05:26.052853 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2022-03-13 22:05:26.054853 (MainThread): Parsing macros\schema_tests\not_null.sql
2022-03-13 22:05:26.055845 (MainThread): Parsing macros\schema_tests\relationships.sql
2022-03-13 22:05:26.057841 (MainThread): Parsing macros\schema_tests\unique.sql
2022-03-13 22:05:26.236362 (MainThread): Acquiring new snowflake connection "model.fullscript_takehome.CustomerDim".
2022-03-13 22:05:26.248331 (MainThread): Acquiring new snowflake connection "model.fullscript_takehome.OrdersFact".
2022-03-13 22:05:26.264288 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.fullscript_takehome.example

2022-03-13 22:05:26.270162 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4dabe521-21fd-42fa-b522-1ac69ce12ea6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018D636210D0>]}
2022-03-13 22:05:26.305096 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2022-03-13 22:05:26.305096 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4dabe521-21fd-42fa-b522-1ac69ce12ea6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018D6345F070>]}
2022-03-13 22:05:26.306095 (MainThread): Found 2 models, 0 tests, 0 snapshots, 0 analyses, 172 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2022-03-13 22:05:26.307094 (MainThread): 
2022-03-13 22:05:26.311063 (MainThread): Acquiring new snowflake connection "master".
2022-03-13 22:05:26.312057 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_SNOWFLAKE_SAMPLE_DATA".
2022-03-13 22:05:26.323027 (ThreadPoolExecutor-0_0): Using snowflake connection "list_SNOWFLAKE_SAMPLE_DATA".
2022-03-13 22:05:26.323027 (ThreadPoolExecutor-0_0): On list_SNOWFLAKE_SAMPLE_DATA: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "snowflakedb", "target_name": "prod", "connection_name": "list_SNOWFLAKE_SAMPLE_DATA"} */

    show terse schemas in database SNOWFLAKE_SAMPLE_DATA
    limit 10000
2022-03-13 22:05:26.323027 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2022-03-13 22:05:27.119328 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 8 in 0.80 seconds
2022-03-13 22:05:27.127305 (ThreadPoolExecutor-0_0): On list_SNOWFLAKE_SAMPLE_DATA: Close
2022-03-13 22:05:27.278122 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_SNOWFLAKE_SAMPLE_DATA_TPCH_SF1".
2022-03-13 22:05:27.289111 (ThreadPoolExecutor-1_0): Using snowflake connection "list_SNOWFLAKE_SAMPLE_DATA_TPCH_SF1".
2022-03-13 22:05:27.290109 (ThreadPoolExecutor-1_0): On list_SNOWFLAKE_SAMPLE_DATA_TPCH_SF1: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "snowflakedb", "target_name": "prod", "connection_name": "list_SNOWFLAKE_SAMPLE_DATA_TPCH_SF1"} */

    show terse objects in SNOWFLAKE_SAMPLE_DATA.TPCH_SF1
2022-03-13 22:05:27.290109 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2022-03-13 22:05:28.027543 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 8 in 0.74 seconds
2022-03-13 22:05:28.032569 (ThreadPoolExecutor-1_0): On list_SNOWFLAKE_SAMPLE_DATA_TPCH_SF1: Close
2022-03-13 22:05:28.185811 (MainThread): 18:05:28 | Concurrency: 10 threads (target='prod')
2022-03-13 22:05:28.187807 (MainThread): 18:05:28 | 
2022-03-13 22:05:28.206873 (Thread-1): Began running node model.fullscript_takehome.CustomerDim
2022-03-13 22:05:28.206873 (Thread-2): Began running node model.fullscript_takehome.OrdersFact
2022-03-13 22:05:28.207833 (Thread-1): 18:05:28 | 1 of 2 START table model TPCH_SF1.CustomerDim........................ [RUN]
2022-03-13 22:05:28.208862 (Thread-2): 18:05:28 | 2 of 2 START table model TPCH_SF1.OrdersFact......................... [RUN]
2022-03-13 22:05:28.209829 (Thread-1): Acquiring new snowflake connection "model.fullscript_takehome.CustomerDim".
2022-03-13 22:05:28.210828 (Thread-1): Compiling model.fullscript_takehome.CustomerDim
2022-03-13 22:05:28.215841 (Thread-1): Writing injected SQL for node "model.fullscript_takehome.CustomerDim"
2022-03-13 22:05:28.215841 (Thread-2): Acquiring new snowflake connection "model.fullscript_takehome.OrdersFact".
2022-03-13 22:05:28.216813 (Thread-2): Compiling model.fullscript_takehome.OrdersFact
2022-03-13 22:05:28.221799 (Thread-2): Writing injected SQL for node "model.fullscript_takehome.OrdersFact"
2022-03-13 22:05:28.222796 (Thread-1): finished collecting timing info
2022-03-13 22:05:28.241741 (Thread-2): finished collecting timing info
2022-03-13 22:05:28.268700 (Thread-2): Writing runtime SQL for node "model.fullscript_takehome.OrdersFact"
2022-03-13 22:05:28.273685 (Thread-1): Writing runtime SQL for node "model.fullscript_takehome.CustomerDim"
2022-03-13 22:05:28.274653 (Thread-1): Using snowflake connection "model.fullscript_takehome.CustomerDim".
2022-03-13 22:05:28.275678 (Thread-2): Using snowflake connection "model.fullscript_takehome.OrdersFact".
2022-03-13 22:05:28.275678 (Thread-1): On model.fullscript_takehome.CustomerDim: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "snowflakedb", "target_name": "prod", "node_id": "model.fullscript_takehome.CustomerDim"} */


      create or replace transient table SNOWFLAKE_SAMPLE_DATA.TPCH_SF1.CustomerDim  as
      ( 

with customer_dim as (

    SELECT CUSTOMER.C_CUSTKEY
    , CUSTOMER.C_NAME AS CUSTOMERNC_AME
    , CUSTOMER.C_ADDRESS AS CUSTOMERAC_DDRESS
    , NATION.N_NAME AS NATIONNAME
    , REGION.R_NAME AS REGIONNAME
    , CUSTOMER.C_PHONE AS CUSTOMERPC_HONE
    , CUSTOMER.C_ACCTBAL AS CUSTOMERAC_CCTBAL
    , CUSTOMER.C_MKTSEGMENT AS CUSTOMERMC_KTSEGMENT
    , CUSTOMER.C_COMMENT AS CUSTOMERCC_OMMENT    
    FROM CUSTOMER  
    LEFT join NATION  ON CUSTOMER.C_NATIONKEY  = NATION.N_NATIONKEY
    LEFT JOIN REGION  ON NATION.N_REGIONKEY = REGION.R_REGIONKEY 

)

select *
from customer_dim
      );
2022-03-13 22:05:28.275678 (Thread-2): On model.fullscript_takehome.OrdersFact: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "snowflakedb", "target_name": "prod", "node_id": "model.fullscript_takehome.OrdersFact"} */


      create or replace transient table SNOWFLAKE_SAMPLE_DATA.TPCH_SF1.OrdersFact  as
      (

with orders_fact as (

    select o_custkey, 
    o_orderstatus, 
    o_orderpriority, 
    o_orderdate,
    o_shippriority, 
    sum(o_totalprice) as totalprice
    from orders
    group by o_custkey
    , o_orderstatus
    , o_orderpriority
    , o_orderdate
    , o_shippriority

)

select *
from orders_fact
      );
2022-03-13 22:05:28.275678 (Thread-1): Opening a new connection, currently in state init
2022-03-13 22:05:28.276679 (Thread-2): Opening a new connection, currently in state init
2022-03-13 22:05:29.089034 (Thread-2): Snowflake query id: 01a2e82d-0000-4558-0000-00014d8a626d
2022-03-13 22:05:29.090033 (Thread-2): Snowflake error: 003540 (42501): SQL execution error: Creating table on shared database 'SNOWFLAKE_SAMPLE_DATA' is not allowed.
2022-03-13 22:05:29.091066 (Thread-1): Snowflake query id: 01a2e82d-0000-4557-0000-00014d8a3115
2022-03-13 22:05:29.092029 (Thread-2): finished collecting timing info
2022-03-13 22:05:29.092568 (Thread-1): Snowflake error: 003540 (42501): SQL execution error: Creating table on shared database 'SNOWFLAKE_SAMPLE_DATA' is not allowed.
2022-03-13 22:05:29.093241 (Thread-2): On model.fullscript_takehome.OrdersFact: Close
2022-03-13 22:05:29.094023 (Thread-1): finished collecting timing info
2022-03-13 22:05:29.096061 (Thread-1): On model.fullscript_takehome.CustomerDim: Close
2022-03-13 22:05:29.244136 (Thread-2): Database Error in model OrdersFact (models\OrdersFact.sql)
  003540 (42501): SQL execution error: Creating table on shared database 'SNOWFLAKE_SAMPLE_DATA' is not allowed.
  compiled SQL at target\run\fullscript_takehome\models\OrdersFact.sql
Traceback (most recent call last):
  File "C:\Users\susch\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\adapters\snowflake\connections.py", line 183, in exception_handler
    yield
  File "C:\Users\susch\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\adapters\sql\connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
  File "C:\Users\susch\AppData\Local\Programs\Python\Python39\lib\site-packages\snowflake\connector\cursor.py", line 721, in execute
    Error.errorhandler_wrapper(
  File "C:\Users\susch\AppData\Local\Programs\Python\Python39\lib\site-packages\snowflake\connector\errors.py", line 258, in errorhandler_wrapper
    cursor.errorhandler(connection, cursor, error_class, error_value)
  File "C:\Users\susch\AppData\Local\Programs\Python\Python39\lib\site-packages\snowflake\connector\errors.py", line 188, in default_errorhandler
    raise error_class(
snowflake.connector.errors.ProgrammingError: 003540 (42501): SQL execution error: Creating table on shared database 'SNOWFLAKE_SAMPLE_DATA' is not allowed.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\susch\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\task\base.py", line 348, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "C:\Users\susch\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\task\base.py", line 291, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "C:\Users\susch\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\task\base.py", line 393, in run
    return self.execute(compiled_node, manifest)
  File "C:\Users\susch\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\task\run.py", line 249, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "C:\Users\susch\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\clients\jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "C:\Users\susch\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\clients\jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "C:\Users\susch\AppData\Local\Programs\Python\Python39\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "C:\Users\susch\AppData\Local\Programs\Python\Python39\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 65, in macro
  File "C:\Users\susch\AppData\Local\Programs\Python\Python39\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "C:\Users\susch\AppData\Local\Programs\Python\Python39\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "C:\Users\susch\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\clients\jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "C:\Users\susch\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\clients\jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "C:\Users\susch\AppData\Local\Programs\Python\Python39\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "C:\Users\susch\AppData\Local\Programs\Python\Python39\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "C:\Users\susch\AppData\Local\Programs\Python\Python39\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "C:\Users\susch\AppData\Local\Programs\Python\Python39\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "C:\Users\susch\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\adapters\base\impl.py", line 226, in execute
    return self.connections.execute(
  File "C:\Users\susch\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\adapters\sql\connections.py", line 131, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "C:\Users\susch\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\adapters\snowflake\connections.py", line 354, in add_query
    connection, cursor = super().add_query(
  File "C:\Users\susch\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\adapters\sql\connections.py", line 87, in add_query
    return connection, cursor
  File "C:\Users\susch\AppData\Local\Programs\Python\Python39\lib\contextlib.py", line 137, in __exit__
    self.gen.throw(typ, value, traceback)
  File "C:\Users\susch\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\adapters\snowflake\connections.py", line 200, in exception_handler
    raise DatabaseException(msg)
dbt.exceptions.DatabaseException: Database Error in model OrdersFact (models\OrdersFact.sql)
  003540 (42501): SQL execution error: Creating table on shared database 'SNOWFLAKE_SAMPLE_DATA' is not allowed.
  compiled SQL at target\run\fullscript_takehome\models\OrdersFact.sql
2022-03-13 22:05:29.249123 (Thread-2): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4dabe521-21fd-42fa-b522-1ac69ce12ea6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018D638D2F70>]}
2022-03-13 22:05:29.251118 (Thread-2): 18:05:29 | 2 of 2 ERROR creating table model TPCH_SF1.OrdersFact................ [ERROR in 1.03s]
2022-03-13 22:05:29.253886 (Thread-2): Finished running node model.fullscript_takehome.OrdersFact
2022-03-13 22:05:29.290670 (Thread-1): Database Error in model CustomerDim (models\CustomerDim.sql)
  003540 (42501): SQL execution error: Creating table on shared database 'SNOWFLAKE_SAMPLE_DATA' is not allowed.
  compiled SQL at target\run\fullscript_takehome\models\CustomerDim.sql
Traceback (most recent call last):
  File "C:\Users\susch\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\adapters\snowflake\connections.py", line 183, in exception_handler
    yield
  File "C:\Users\susch\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\adapters\sql\connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
  File "C:\Users\susch\AppData\Local\Programs\Python\Python39\lib\site-packages\snowflake\connector\cursor.py", line 721, in execute
    Error.errorhandler_wrapper(
  File "C:\Users\susch\AppData\Local\Programs\Python\Python39\lib\site-packages\snowflake\connector\errors.py", line 258, in errorhandler_wrapper
    cursor.errorhandler(connection, cursor, error_class, error_value)
  File "C:\Users\susch\AppData\Local\Programs\Python\Python39\lib\site-packages\snowflake\connector\errors.py", line 188, in default_errorhandler
    raise error_class(
snowflake.connector.errors.ProgrammingError: 003540 (42501): SQL execution error: Creating table on shared database 'SNOWFLAKE_SAMPLE_DATA' is not allowed.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\susch\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\task\base.py", line 348, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "C:\Users\susch\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\task\base.py", line 291, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "C:\Users\susch\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\task\base.py", line 393, in run
    return self.execute(compiled_node, manifest)
  File "C:\Users\susch\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\task\run.py", line 249, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "C:\Users\susch\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\clients\jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "C:\Users\susch\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\clients\jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "C:\Users\susch\AppData\Local\Programs\Python\Python39\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "C:\Users\susch\AppData\Local\Programs\Python\Python39\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 65, in macro
  File "C:\Users\susch\AppData\Local\Programs\Python\Python39\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "C:\Users\susch\AppData\Local\Programs\Python\Python39\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "C:\Users\susch\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\clients\jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "C:\Users\susch\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\clients\jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "C:\Users\susch\AppData\Local\Programs\Python\Python39\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "C:\Users\susch\AppData\Local\Programs\Python\Python39\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "C:\Users\susch\AppData\Local\Programs\Python\Python39\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "C:\Users\susch\AppData\Local\Programs\Python\Python39\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "C:\Users\susch\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\adapters\base\impl.py", line 226, in execute
    return self.connections.execute(
  File "C:\Users\susch\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\adapters\sql\connections.py", line 131, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "C:\Users\susch\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\adapters\snowflake\connections.py", line 354, in add_query
    connection, cursor = super().add_query(
  File "C:\Users\susch\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\adapters\sql\connections.py", line 87, in add_query
    return connection, cursor
  File "C:\Users\susch\AppData\Local\Programs\Python\Python39\lib\contextlib.py", line 137, in __exit__
    self.gen.throw(typ, value, traceback)
  File "C:\Users\susch\AppData\Local\Programs\Python\Python39\lib\site-packages\dbt\adapters\snowflake\connections.py", line 200, in exception_handler
    raise DatabaseException(msg)
dbt.exceptions.DatabaseException: Database Error in model CustomerDim (models\CustomerDim.sql)
  003540 (42501): SQL execution error: Creating table on shared database 'SNOWFLAKE_SAMPLE_DATA' is not allowed.
  compiled SQL at target\run\fullscript_takehome\models\CustomerDim.sql
2022-03-13 22:05:29.295656 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4dabe521-21fd-42fa-b522-1ac69ce12ea6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018D6379CB50>]}
2022-03-13 22:05:29.296654 (Thread-1): 18:05:29 | 1 of 2 ERROR creating table model TPCH_SF1.CustomerDim............... [ERROR in 1.09s]
2022-03-13 22:05:29.299648 (Thread-1): Finished running node model.fullscript_takehome.CustomerDim
2022-03-13 22:05:29.304632 (MainThread): Acquiring new snowflake connection "master".
2022-03-13 22:05:29.305628 (MainThread): 18:05:29 | 
2022-03-13 22:05:29.306658 (MainThread): 18:05:29 | Finished running 2 table models in 2.99s.
2022-03-13 22:05:29.308615 (MainThread): Connection 'master' was properly closed.
2022-03-13 22:05:29.309612 (MainThread): Connection 'list_SNOWFLAKE_SAMPLE_DATA' was properly closed.
2022-03-13 22:05:29.309612 (MainThread): Connection 'list_SNOWFLAKE_SAMPLE_DATA_TPCH_SF1' was properly closed.
2022-03-13 22:05:29.310611 (MainThread): Connection 'model.fullscript_takehome.CustomerDim' was properly closed.
2022-03-13 22:05:29.310611 (MainThread): Connection 'model.fullscript_takehome.OrdersFact' was properly closed.
2022-03-13 22:05:29.324577 (MainThread): 
2022-03-13 22:05:29.325698 (MainThread): Completed with 2 errors and 0 warnings:
2022-03-13 22:05:29.328481 (MainThread): 
2022-03-13 22:05:29.331080 (MainThread): Database Error in model OrdersFact (models\OrdersFact.sql)
2022-03-13 22:05:29.334825 (MainThread):   003540 (42501): SQL execution error: Creating table on shared database 'SNOWFLAKE_SAMPLE_DATA' is not allowed.
2022-03-13 22:05:29.338164 (MainThread):   compiled SQL at target\run\fullscript_takehome\models\OrdersFact.sql
2022-03-13 22:05:29.339166 (MainThread): 
2022-03-13 22:05:29.340163 (MainThread): Database Error in model CustomerDim (models\CustomerDim.sql)
2022-03-13 22:05:29.342360 (MainThread):   003540 (42501): SQL execution error: Creating table on shared database 'SNOWFLAKE_SAMPLE_DATA' is not allowed.
2022-03-13 22:05:29.343366 (MainThread):   compiled SQL at target\run\fullscript_takehome\models\CustomerDim.sql
2022-03-13 22:05:29.344362 (MainThread): 
Done. PASS=0 WARN=0 ERROR=2 SKIP=0 TOTAL=2
2022-03-13 22:05:29.348610 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018D6345F790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018D6345FE80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018D6345FD00>]}
2022-03-13 22:05:29.348610 (MainThread): Flushing usage events
